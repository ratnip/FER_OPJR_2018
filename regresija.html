<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Programirajmo u R-u</title>
  <meta name="description" content="Udzbenik za vještinu ‘Osnove programskog jezika R’ na Fakultetu elektrotehnike i racunarstva, Sveuciliste u Zagrebu.">
  <meta name="generator" content="bookdown 0.7 and GitBook 2.6.7">

  <meta property="og:title" content="Programirajmo u R-u" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Udzbenik za vještinu ‘Osnove programskog jezika R’ na Fakultetu elektrotehnike i racunarstva, Sveuciliste u Zagrebu." />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Programirajmo u R-u" />
  
  <meta name="twitter:description" content="Udzbenik za vještinu ‘Osnove programskog jezika R’ na Fakultetu elektrotehnike i racunarstva, Sveuciliste u Zagrebu." />
  

<meta name="author" content="Damir Pintar">


<meta name="date" content="2019-01-22">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="ggplot2.html">
<link rel="next" href="prediktivno-modeliranje.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />








<style type="text/css">
.showopt {
  background-color: #004c93;
  color: #FFFFFF; 
  width: 140px;
  height: 4	0px;
  text-align: center;
  vertical-align: middle !important;
  float: right;
  font-family: sans-serif;
  font-size:10 pt;
  border-radius: 8px;
}

.showopt:hover {
    background-color: #dfe4f2;
    color: #004c93;
}

pre.plot {
  background-color: white !important;
}
</style>

<script>
 $(document).ready(function() {

  $chunks = $('.fold');

  $chunks.each(function () {

    // add button to source code chunks
    if ( $(this).hasClass('s') ) {
      $('pre.r', this).prepend("<div class=\"showopt\">Prikaži rješenje</div><br style=\"line-height:22px;\"/>");
      $('pre.r', this).children('code').attr('class', 'folded');
    }

    // add button to output chunks
    if ( $(this).hasClass('o') ) {
      $('pre:not(.r)', this).has('code').prepend("<div class=\"showopt\">Prikaži ispis</div><br style=\"line-height:22px;\"/>");
      $('pre:not(.r)', this).children('code:not(r)').addClass('folded');

      // add button to plots
      $(this).find('img').wrap('<pre class=\"plot\"></pre>');
      $('pre.plot', this).prepend("<div class=\"showopt\">Prikaži sliku</div><br style=\"line-height:22px;\"/>");
      $('pre.plot', this).children('img').addClass('folded');

    }
  });

  // hide all chunks when document is loaded
  $('.folded').css('display', 'none')

  // function to toggle the visibility
  $('.showopt').click(function() {
    var label = $(this).html();
    if (label.indexOf("Prikaži") >= 0) {
      $(this).html(label.replace("Prikaži", "Sakrij"));
    } else {
      $(this).html(label.replace("Sakrij", "Prikaži"));
    }
    $(this).siblings('code, img').slideToggle('fast', 'swing');
  });
});
</script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>(Udžbenik za vještinu “Osnove programskog jezika R”)</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#predgovor"><i class="fa fa-check"></i>Predgovor</a></li>
</ul></li>
<li class="part"><span><b>I Osnovni elementi jezika R</b></span></li>
<li class="chapter" data-level="1" data-path="uvod.html"><a href="uvod.html"><i class="fa fa-check"></i><b>1</b> Uvod</a><ul>
<li class="chapter" data-level="1.1" data-path="uvod.html"><a href="uvod.html#sto-je-programski-jezik-r"><i class="fa fa-check"></i><b>1.1</b> Što je programski jezik R?</a><ul>
<li class="chapter" data-level="1.1.1" data-path="uvod.html"><a href="uvod.html#opcenito-o-r-u"><i class="fa fa-check"></i><b>1.1.1</b> Općenito o R-u</a></li>
<li class="chapter" data-level="1.1.2" data-path="uvod.html"><a href="uvod.html#alternative-jeziku-r"><i class="fa fa-check"></i><b>1.1.2</b> Alternative jeziku R</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="uvod.html"><a href="uvod.html#instalacija-programske-podrske"><i class="fa fa-check"></i><b>1.2</b> Instalacija programske podrške</a></li>
<li class="chapter" data-level="1.3" data-path="uvod.html"><a href="uvod.html#pregled-razvojnog-sucelja-rstudio"><i class="fa fa-check"></i><b>1.3</b> Pregled razvojnog sučelja <em>RStudio</em></a><ul>
<li class="chapter" data-level="1.3.1" data-path="uvod.html"><a href="uvod.html#interaktivna-konzola"><i class="fa fa-check"></i><b>1.3.1</b> Interaktivna konzola</a></li>
<li class="chapter" data-level="1.3.2" data-path="uvod.html"><a href="uvod.html#pisanje-r-skripti"><i class="fa fa-check"></i><b>1.3.2</b> Pisanje R skripti</a></li>
<li class="chapter" data-level="1.3.3" data-path="uvod.html"><a href="uvod.html#r-markdown"><i class="fa fa-check"></i><b>1.3.3</b> <em>R Markdown</em></a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="uvod.html"><a href="uvod.html#kako-koristiti-ovaj-udzbenik"><i class="fa fa-check"></i><b>1.4</b> Kako koristiti ovaj udžbenik?</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="tipovi.html"><a href="tipovi.html"><i class="fa fa-check"></i><b>2</b> Osnovni tipovi podataka i operatori</a><ul>
<li class="chapter" data-level="2.1" data-path="tipovi.html"><a href="tipovi.html#osnovni-tipovi-podataka"><i class="fa fa-check"></i><b>2.1</b> Osnovni tipovi podataka</a></li>
<li class="chapter" data-level="2.2" data-path="tipovi.html"><a href="tipovi.html#operatori"><i class="fa fa-check"></i><b>2.2</b> Operatori</a></li>
<li class="chapter" data-level="2.3" data-path="tipovi.html"><a href="tipovi.html#nedostajuce-nepoznate-i-nemoguce-vrijednosti"><i class="fa fa-check"></i><b>2.3</b> Nedostajuće, nepoznate i nemoguće vrijednosti</a></li>
<li class="chapter" data-level="" data-path="tipovi.html"><a href="tipovi.html#zadaci-za-vjezbu"><i class="fa fa-check"></i>Zadaci za vježbu</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="vektori.html"><a href="vektori.html"><i class="fa fa-check"></i><b>3</b> Vektori, matrice i liste</a><ul>
<li class="chapter" data-level="3.1" data-path="vektori.html"><a href="vektori.html#vektori-1"><i class="fa fa-check"></i><b>3.1</b> Vektori</a><ul>
<li class="chapter" data-level="3.1.1" data-path="vektori.html"><a href="vektori.html#stvaranje-vektora"><i class="fa fa-check"></i><b>3.1.1</b> Stvaranje vektora</a></li>
<li class="chapter" data-level="3.1.2" data-path="vektori.html"><a href="vektori.html#operator"><i class="fa fa-check"></i><b>3.1.2</b> Operator <code>[</code></a></li>
<li class="chapter" data-level="3.1.3" data-path="vektori.html"><a href="vektori.html#principi-vektorizacije-i-recikliranja"><i class="fa fa-check"></i><b>3.1.3</b> Principi vektorizacije i recikliranja</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="vektori.html"><a href="vektori.html#indeksni-vektori"><i class="fa fa-check"></i><b>3.2</b> Indeksni vektori</a><ul>
<li class="chapter" data-level="3.2.1" data-path="vektori.html"><a href="vektori.html#lokacijsko-referenciranje"><i class="fa fa-check"></i><b>3.2.1</b> Lokacijsko referenciranje</a></li>
<li class="chapter" data-level="3.2.2" data-path="vektori.html"><a href="vektori.html#uvjetno-referenciranje"><i class="fa fa-check"></i><b>3.2.2</b> Uvjetno referenciranje</a></li>
<li class="chapter" data-level="3.2.3" data-path="vektori.html"><a href="vektori.html#imensko-referenciranje"><i class="fa fa-check"></i><b>3.2.3</b> Imensko referenciranje</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="vektori.html"><a href="vektori.html#matrice-i-polja"><i class="fa fa-check"></i><b>3.3</b> Matrice i polja</a><ul>
<li class="chapter" data-level="3.3.1" data-path="vektori.html"><a href="vektori.html#rezanje-matrica"><i class="fa fa-check"></i><b>3.3.1</b> Rezanje matrica</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="vektori.html"><a href="vektori.html#liste"><i class="fa fa-check"></i><b>3.4</b> Liste</a></li>
<li class="chapter" data-level="" data-path="vektori.html"><a href="vektori.html#zadaci-za-vjezbu-1"><i class="fa fa-check"></i>Zadaci za vježbu</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="okviri.html"><a href="okviri.html"><i class="fa fa-check"></i><b>4</b> Podatkovni okviri i faktori</a><ul>
<li class="chapter" data-level="4.1" data-path="okviri.html"><a href="okviri.html#podatkovni-okviri"><i class="fa fa-check"></i><b>4.1</b> Podatkovni okviri</a></li>
<li class="chapter" data-level="4.2" data-path="okviri.html"><a href="okviri.html#odabir-redaka-i-stupaca-podatkovnih-okvira"><i class="fa fa-check"></i><b>4.2</b> Odabir redaka i stupaca podatkovnih okvira</a></li>
<li class="chapter" data-level="4.3" data-path="okviri.html"><a href="okviri.html#dodavanje-i-brisanje-redaka-i-stupaca"><i class="fa fa-check"></i><b>4.3</b> Dodavanje i brisanje redaka i stupaca</a></li>
<li class="chapter" data-level="4.4" data-path="okviri.html"><a href="okviri.html#faktori"><i class="fa fa-check"></i><b>4.4</b> Faktori</a></li>
<li class="chapter" data-level="" data-path="okviri.html"><a href="okviri.html#zadaci-za-vjezbu-2"><i class="fa fa-check"></i>Zadaci za vježbu</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="kontrola.html"><a href="kontrola.html"><i class="fa fa-check"></i><b>5</b> Kontrola toka i objekti</a><ul>
<li class="chapter" data-level="5.1" data-path="kontrola.html"><a href="kontrola.html#naredbe-kontrole-toka"><i class="fa fa-check"></i><b>5.1</b> Naredbe kontrole toka</a><ul>
<li class="chapter" data-level="5.1.1" data-path="kontrola.html"><a href="kontrola.html#uvjetno-izvoenje-naredbi"><i class="fa fa-check"></i><b>5.1.1</b> Uvjetno izvođenje naredbi</a></li>
<li class="chapter" data-level="5.1.2" data-path="kontrola.html"><a href="kontrola.html#programske-petlje"><i class="fa fa-check"></i><b>5.1.2</b> Programske petlje</a></li>
<li class="chapter" data-level="5.1.3" data-path="kontrola.html"><a href="kontrola.html#petlja-repeat"><i class="fa fa-check"></i><b>5.1.3</b> Petlja <code>repeat</code></a></li>
<li class="chapter" data-level="5.1.4" data-path="kontrola.html"><a href="kontrola.html#petlja-while"><i class="fa fa-check"></i><b>5.1.4</b> Petlja <code>while</code></a></li>
<li class="chapter" data-level="5.1.5" data-path="kontrola.html"><a href="kontrola.html#petlja-for"><i class="fa fa-check"></i><b>5.1.5</b> Petlja <code>for</code></a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="kontrola.html"><a href="kontrola.html#objektni-modeli-u-jeziku-r"><i class="fa fa-check"></i><b>5.2</b> Objektni modeli u jeziku R</a><ul>
<li class="chapter" data-level="5.2.1" data-path="kontrola.html"><a href="kontrola.html#pregled-objektnog-modela-s3"><i class="fa fa-check"></i><b>5.2.1</b> Pregled objektnog modela S3</a></li>
<li class="chapter" data-level="5.2.2" data-path="kontrola.html"><a href="kontrola.html#genericke-funkcije"><i class="fa fa-check"></i><b>5.2.2</b> Generičke funkcije</a></li>
<li class="chapter" data-level="5.2.3" data-path="kontrola.html"><a href="kontrola.html#zakljucci-o-s3-objektima"><i class="fa fa-check"></i><b>5.2.3</b> Zaključci o S3 objektima</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="kontrola.html"><a href="kontrola.html#zadaci-za-vjezbu-3"><i class="fa fa-check"></i>Zadaci za vježbu</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="paketi.html"><a href="paketi.html"><i class="fa fa-check"></i><b>6</b> Paketi, ugrađene funkcije i okoline</a><ul>
<li class="chapter" data-level="6.1" data-path="paketi.html"><a href="paketi.html#rad-s-paketima"><i class="fa fa-check"></i><b>6.1</b> Rad s paketima</a></li>
<li class="chapter" data-level="6.2" data-path="paketi.html"><a href="paketi.html#ugraene-funkcije"><i class="fa fa-check"></i><b>6.2</b> Ugrađene funkcije</a></li>
<li class="chapter" data-level="6.3" data-path="paketi.html"><a href="paketi.html#okoline"><i class="fa fa-check"></i><b>6.3</b> Okoline</a></li>
<li class="chapter" data-level="" data-path="paketi.html"><a href="paketi.html#zadaci-za-vjezbu-4"><i class="fa fa-check"></i>Zadaci za vježbu</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="korisnik.html"><a href="korisnik.html"><i class="fa fa-check"></i><b>7</b> Korisnički definirane funkcije</a><ul>
<li class="chapter" data-level="7.1" data-path="korisnik.html"><a href="korisnik.html#kako-definirati-funkciju"><i class="fa fa-check"></i><b>7.1</b> Kako definirati funkciju</a><ul>
<li class="chapter" data-level="7.1.1" data-path="korisnik.html"><a href="korisnik.html#princip-kopiranja-kod-izmjene-copy-on-modify"><i class="fa fa-check"></i><b>7.1.1</b> Princip “kopiranja kod izmjene” (copy-on-modify)</a></li>
<li class="chapter" data-level="7.1.2" data-path="korisnik.html"><a href="korisnik.html#funkcija-kao-objekt"><i class="fa fa-check"></i><b>7.1.2</b> Funkcija kao objekt</a></li>
<li class="chapter" data-level="7.1.3" data-path="korisnik.html"><a href="korisnik.html#genericke-funkcije-1"><i class="fa fa-check"></i><b>7.1.3</b> Generičke funkcije</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="korisnik.html"><a href="korisnik.html#zadaci-za-vjezbu-5"><i class="fa fa-check"></i>Zadaci za vježbu</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="apply.html"><a href="apply.html"><i class="fa fa-check"></i><b>8</b> Porodica funkcija <code>apply</code></a><ul>
<li class="chapter" data-level="8.1" data-path="apply.html"><a href="apply.html#sto-su-apply-funkcije"><i class="fa fa-check"></i><b>8.1</b> Što su <code>apply</code> funkcije?</a></li>
<li class="chapter" data-level="8.2" data-path="apply.html"><a href="apply.html#funkcija-apply"><i class="fa fa-check"></i><b>8.2</b> Funkcija <code>apply</code></a></li>
<li class="chapter" data-level="8.3" data-path="apply.html"><a href="apply.html#funkcije-lapply-sapply-i-vapply"><i class="fa fa-check"></i><b>8.3</b> Funkcije <code>lapply</code>, <code>sapply</code> i <code>vapply</code></a></li>
<li class="chapter" data-level="8.4" data-path="apply.html"><a href="apply.html#ostale-funkcije-iz-porodice-apply-i-dostupne-alternative"><i class="fa fa-check"></i><b>8.4</b> Ostale funkcije iz porodice <code>apply</code> i dostupne alternative</a></li>
<li class="chapter" data-level="" data-path="apply.html"><a href="apply.html#zadaci-za-vjezbu-6"><i class="fa fa-check"></i>Zadaci za vježbu</a></li>
</ul></li>
<li class="part"><span><b>II Upravljanje podacima i vizualizacije</b></span></li>
<li class="chapter" data-level="9" data-path="cijev.html"><a href="cijev.html"><i class="fa fa-check"></i><b>9</b> Operator cjevovoda i uredni podaci</a><ul>
<li class="chapter" data-level="9.1" data-path="cijev.html"><a href="cijev.html#operator-cjevovoda"><i class="fa fa-check"></i><b>9.1</b> Operator cjevovoda</a></li>
<li class="chapter" data-level="9.2" data-path="cijev.html"><a href="cijev.html#uredni-podaci"><i class="fa fa-check"></i><b>9.2</b> Uredni podaci</a><ul>
<li class="chapter" data-level="9.2.1" data-path="cijev.html"><a href="cijev.html#funkcije-gather-i-spread"><i class="fa fa-check"></i><b>9.2.1</b> Funkcije <code>gather</code> i <code>spread</code></a></li>
<li class="chapter" data-level="9.2.2" data-path="cijev.html"><a href="cijev.html#funkcije-separate-i-unite"><i class="fa fa-check"></i><b>9.2.2</b> Funkcije <code>separate</code> i <code>unite</code></a></li>
</ul></li>
<li class="chapter" data-level="" data-path="cijev.html"><a href="cijev.html#zadaci-za-vjezbu-7"><i class="fa fa-check"></i>Zadaci za vježbu</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="datumi.html"><a href="datumi.html"><i class="fa fa-check"></i><b>10</b> Rad sa datumima i znakovnim nizovima</a><ul>
<li class="chapter" data-level="10.1" data-path="datumi.html"><a href="datumi.html#rad-sa-datumima"><i class="fa fa-check"></i><b>10.1</b> Rad sa datumima</a><ul>
<li class="chapter" data-level="10.1.1" data-path="datumi.html"><a href="datumi.html#klasa-date"><i class="fa fa-check"></i><b>10.1.1</b> Klasa <code>Date</code></a></li>
<li class="chapter" data-level="10.1.2" data-path="datumi.html"><a href="datumi.html#klase-posixct-i-posixlt"><i class="fa fa-check"></i><b>10.1.2</b> Klase <code>POSIXct</code> i <code>POSIXlt</code></a></li>
<li class="chapter" data-level="10.1.3" data-path="datumi.html"><a href="datumi.html#paket-lubridate"><i class="fa fa-check"></i><b>10.1.3</b> Paket <code>lubridate</code></a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="datumi.html"><a href="datumi.html#rad-sa-znakovnim-nizovima"><i class="fa fa-check"></i><b>10.2</b> Rad sa znakovnim nizovima</a><ul>
<li class="chapter" data-level="10.2.1" data-path="datumi.html"><a href="datumi.html#analiza-teksta-i-regularni-izrazi"><i class="fa fa-check"></i><b>10.2.1</b> Analiza teksta i regularni izrazi</a></li>
<li class="chapter" data-level="10.2.2" data-path="datumi.html"><a href="datumi.html#paket-stringr"><i class="fa fa-check"></i><b>10.2.2</b> Paket <code>stringr</code></a></li>
</ul></li>
<li class="chapter" data-level="" data-path="datumi.html"><a href="datumi.html#zadaci-za-vjezbu-8"><i class="fa fa-check"></i>Zadaci za vježbu</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html"><i class="fa fa-check"></i><b>11</b> Prilagodba podatkovnih skupova uz paket <code>dplyr</code></a><ul>
<li class="chapter" data-level="11.1" data-path="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#ogledni-podatkovni-skup-titanic"><i class="fa fa-check"></i><b>11.1</b> Ogledni podatkovni skup: <em>Titanic</em></a></li>
<li class="chapter" data-level="11.2" data-path="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#stvaranje-podskupa-obzervacija-uz-filter-i-slice"><i class="fa fa-check"></i><b>11.2</b> Stvaranje podskupa obzervacija uz <code>filter</code> i <code>slice</code></a></li>
<li class="chapter" data-level="11.3" data-path="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#stvaranje-podskupa-varijabli-uz-select"><i class="fa fa-check"></i><b>11.3</b> Stvaranje podskupa varijabli uz <code>select</code></a></li>
<li class="chapter" data-level="11.4" data-path="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#stvaranje-novih-stupaca-uz-mutate"><i class="fa fa-check"></i><b>11.4</b> Stvaranje novih stupaca uz <code>mutate</code></a></li>
<li class="chapter" data-level="11.5" data-path="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#ogledni-podatkovni-skup-houston-flights"><i class="fa fa-check"></i><b>11.5</b> Ogledni podatkovni skup: <em>Houston flights</em></a></li>
<li class="chapter" data-level="11.6" data-path="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#grupiranje-i-agregacija-uz-group_by-i-summarise"><i class="fa fa-check"></i><b>11.6</b> Grupiranje i agregacija uz <code>group_by</code> i <code>summarise</code></a></li>
<li class="chapter" data-level="11.7" data-path="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#spajanje-podatkovnih-okvira-uz-join-funkcije"><i class="fa fa-check"></i><b>11.7</b> Spajanje podatkovnih okvira uz join funkcije</a></li>
<li class="chapter" data-level="11.8" data-path="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#integracija-sa-relacijskim-bazama-podataka"><i class="fa fa-check"></i><b>11.8</b> Integracija sa relacijskim bazama podataka</a></li>
<li class="chapter" data-level="" data-path="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#zadaci-za-vjezbu-9"><i class="fa fa-check"></i>Zadaci za vježbu</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="ggplot2.html"><a href="ggplot2.html"><i class="fa fa-check"></i><b>12</b> Vizualizacija podataka uz paket <code>ggplot2</code></a><ul>
<li class="chapter" data-level="12.1" data-path="ggplot2.html"><a href="ggplot2.html#eksploratorna-analiza-podataka"><i class="fa fa-check"></i><b>12.1</b> Eksploratorna analiza podataka</a></li>
<li class="chapter" data-level="12.2" data-path="ggplot2.html"><a href="ggplot2.html#vizualizacija-podataka-uz-pomoc-jezika-r"><i class="fa fa-check"></i><b>12.2</b> Vizualizacija podataka uz pomoć jezika R</a></li>
<li class="chapter" data-level="12.3" data-path="ggplot2.html"><a href="ggplot2.html#graficka-gramatika-i-paket-ggplot2"><i class="fa fa-check"></i><b>12.3</b> Grafička gramatika i paket <code>ggplot2</code></a><ul>
<li class="chapter" data-level="12.3.1" data-path="ggplot2.html"><a href="ggplot2.html#aspekti-podataka-estetike-i-geometrije"><i class="fa fa-check"></i><b>12.3.1</b> Aspekti podataka, estetike i geometrije</a></li>
<li class="chapter" data-level="12.3.2" data-path="ggplot2.html"><a href="ggplot2.html#fiksni-parametri-geometrije"><i class="fa fa-check"></i><b>12.3.2</b> Fiksni parametri geometrije</a></li>
<li class="chapter" data-level="12.3.3" data-path="ggplot2.html"><a href="ggplot2.html#aspekti-statistike-i-pozicije"><i class="fa fa-check"></i><b>12.3.3</b> Aspekti statistike i pozicije</a></li>
<li class="chapter" data-level="12.3.4" data-path="ggplot2.html"><a href="ggplot2.html#povezanost-geometrije-i-statistike"><i class="fa fa-check"></i><b>12.3.4</b> Povezanost geometrije i statistike</a></li>
<li class="chapter" data-level="12.3.5" data-path="ggplot2.html"><a href="ggplot2.html#aspekti-skale-koordinatnog-sustava-i-teme"><i class="fa fa-check"></i><b>12.3.5</b> Aspekti skale, koordinatnog sustava i teme</a></li>
<li class="chapter" data-level="12.3.6" data-path="ggplot2.html"><a href="ggplot2.html#uvjetni-facetirani-grafovi"><i class="fa fa-check"></i><b>12.3.6</b> Uvjetni (facetirani) grafovi</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="ggplot2.html"><a href="ggplot2.html#grafovi-u-eksploratornoj-analizi-i-izvjestavanju"><i class="fa fa-check"></i><b>12.4</b> Grafovi u eksploratornoj analizi i izvještavanju</a></li>
<li class="chapter" data-level="" data-path="ggplot2.html"><a href="ggplot2.html#zadaci-za-vjezbu-10"><i class="fa fa-check"></i>Zadaci za vježbu</a></li>
</ul></li>
<li class="part"><span><b>III Strojno učenje i prediktivna analitika</b></span></li>
<li class="chapter" data-level="13" data-path="regresija.html"><a href="regresija.html"><i class="fa fa-check"></i><b>13</b> Odabrane metode strojnog učenja: regresijska analiza</a><ul>
<li class="chapter" data-level="13.1" data-path="regresija.html"><a href="regresija.html#strojno-ucenje"><i class="fa fa-check"></i><b>13.1</b> Strojno učenje</a><ul>
<li class="chapter" data-level="13.1.1" data-path="regresija.html"><a href="regresija.html#jednostavna-linearna-regresija"><i class="fa fa-check"></i><b>13.1.1</b> Jednostavna linearna regresija</a></li>
<li class="chapter" data-level="13.1.2" data-path="regresija.html"><a href="regresija.html#funkcija-lm"><i class="fa fa-check"></i><b>13.1.2</b> Funkcija <code>lm</code></a></li>
<li class="chapter" data-level="13.1.3" data-path="regresija.html"><a href="regresija.html#linearna-regresija-i-kategorijske-varijable"><i class="fa fa-check"></i><b>13.1.3</b> Linearna regresija i kategorijske varijable</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="regresija.html"><a href="regresija.html#visestruka-multipla-linearna-regresija"><i class="fa fa-check"></i><b>13.2</b> Višestruka (multipla) linearna regresija</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="prediktivno-modeliranje.html"><a href="prediktivno-modeliranje.html"><i class="fa fa-check"></i><b>14</b> Uvod u prediktivno modeliranje</a><ul>
<li class="chapter" data-level="14.1" data-path="prediktivno-modeliranje.html"><a href="prediktivno-modeliranje.html#sto-je-prediktivno-modeliranje"><i class="fa fa-check"></i><b>14.1</b> Što je prediktivno modeliranje?</a></li>
<li class="chapter" data-level="14.2" data-path="prediktivno-modeliranje.html"><a href="prediktivno-modeliranje.html#podaci-za-treniranje-i-testiranje-modela"><i class="fa fa-check"></i><b>14.2</b> Podaci za treniranje i testiranje modela</a></li>
<li class="chapter" data-level="14.3" data-path="prediktivno-modeliranje.html"><a href="prediktivno-modeliranje.html#klasifikacijski-prediktivni-modeli---knn-klasifikacija"><i class="fa fa-check"></i><b>14.3</b> Klasifikacijski prediktivni modeli - kNN klasifikacija</a></li>
<li class="chapter" data-level="14.4" data-path="prediktivno-modeliranje.html"><a href="prediktivno-modeliranje.html#paket-caret-i-prediktivno-modeliranje"><i class="fa fa-check"></i><b>14.4</b> Paket <code>caret</code> i prediktivno modeliranje</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Programirajmo u R-u</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="regresija" class="section level1">
<h1><span class="header-section-number">13</span> Odabrane metode strojnog učenja: regresijska analiza</h1>
<hr />
<div id="strojno-ucenje" class="section level2">
<h2><span class="header-section-number">13.1</span> Strojno učenje</h2>
<p><em>Strojno učenje</em> je polje računalne znanosti koje se bavi specifičnim načinom programiranja u kojem računalu ne dajemo eksplicitne instrukcije, već očekujemo da računalo samostalno dođe do određenih spoznaja na osnovu odabranih podatkovnih skupova i određene metode “učenja”. Strojno učenje se često dijeli na tzv. “nadzirano učenje” (engl. <em>supervised learning</em>), gdje imamo jasno definirane ulaze i izlaze tj. ciljeve, te “nenadzirano učenje” (engl. <em>unsupervised learning</em>), gdje nemamo unaprijed definirane izlaze već očekujemo da će računalo analizirajući samo ulaze doći do nekih korisnih spoznaja o samim podacima. Postoje i dodatne discipline strojnog učenja kao što su “poticano učenje” (engl. <em>reinforced learning</em>), detekcija anomalija (engl. <em>anomaly detection</em>) itd. koje nećemo dodatno objašnjavati budući da izlaze iz okvira ovog udžbenika.</p>
<p>Pojam strojnog učenja često se povezuje sa pojmom “dubinske analize podataka” (engl. <em>data mining</em>) i “otjrivanja znanja iz podatkovnih skupova” (engl. <em>KDD - knowledge discovery from data</em>). Teško je odrediti u kojoj mjeri se ovi pojmovi preklapaju i koje su njihove točne definicije, budući da se u literaturi često nailazi na različite konvencije koje nisu međusobno konzistentne. Za potrebe ovog udžbenika možemo smatrati da strojno učenje daje svojevrsni “alat” kojeg možemo koristiti za otkrivanje (rudarenje) korisnih informacija iz skupova podataka. Rezultat ovog procesa daje nam izvjesno znanje o domenu kojeg možemo koristiti za donošenje određenih odluka.</p>
<p>U ovoj lekciji mi ćemo se usredotočiti na prikaz jedne vrlo često korištene metode strojnog učenja - <strong>linearne regresije</strong> - pri čemu ćemo naglasak dati na njezino korištenje u sklopu programskog jezika R.</p>
<p>Linearna regresija je iznimno popularna metoda strojnog učenja koja uz pomoć matematičkih i statističkih temelja opisuje potencijalnu linearnu povezanost varijabli podatkovnog skupa. Ukoliko se pronađe dovoljno dokaza da linearna povezanost postoji, onda smo dobili potencijalno koristan uvid u stvarni odnos dvaju varijabli skupa. Isto tako, dobivena “formula” se može koristiti da se na osnovu poznate vrijednosti jedne varijable (prediktora) s određenom sigurnosti procijeni vrijednost druge (ciljne) varijable.</p>
<p>Iako danas postoje puno naprednije prediktivne metode, linearna regresija se i dalje često koristi kako zbog svoje jednostavnosti, tako i zbog činjenice razumijevanje linearne regresije postavlja čvrste temelje za učenje i razumijevanje naprednijih metoda. Zbog svega toga, linearna regresija predstavlja logičan i vrlo važan prvi korak za ulazak u svijet prediktivne analize.</p>
<hr />
<div id="jednostavna-linearna-regresija" class="section level3">
<h3><span class="header-section-number">13.1.1</span> Jednostavna linearna regresija</h3>
<p>Jednostavna linearna regresija je metoda nadziranog strojnog učenja za predviđanje ciljne numeričke varijable uz pomoć linearne funkcije ulazne varijable. Na ovaj način stvaranje prediktivnog modela svodi se na postupak određivanja koeficijenta smjera i odsječka koji će tvoriti jednostavnu formulu za izračun ciljne varijable uz pomoć ulaznog parametra. Budući da se ova metoda svodi na pogađanje navedenih parametara, metoda linearne regresije spada u tzv. “parametarske metode” strojnog učenja, tj. prediktivne analize.</p>
<p>Jednostavna linearna regresija počiva na matematičkim temeljima. Najčešće korištena metoda određivanja koeficijenta smjera i odsječka jest <strong>metoda najmanjih kvadrata</strong>, koja povlači pravac između točaka grafa tako da je suma kvadrata udaljenosti točaka od pravca (tzv. reziduali) minimalna. Matematičkim postupkom možemo izvesti formulu koja će egzaktno izračunati navedene parametre, pod uvjetom da imamo dovoljno obzervacija.</p>
<p>Motivaciju za provođenje jednostavne linearne regresije često nalazimo tijekom procesa eksploratorne analize podataka, poglavito tijekom vizualizacije dvije numeričke varijable točkastim grafovima. Ukoliko je jedna od tih varijabli nama interesantna kao ciljna varijabla prediktivnog modela, a na grafu povijesnih podataka vidimo kako u međuodnosu s nekom drugom varijablu točke tvore približni oblik pravca, onda se tu radi o očitom kandidatu za metodu jednostavne linearne regresije.</p>
<hr />
<p>Pogledajmo sljedeći zadatak. U njemu ćemo koristiti “umjetni” podatkovni okvir u kojem imamo ulaznu varijablu <code>x</code> i četiri moguće ciljne varijable <code>y1</code>, <code>y2</code>, <code>y3</code> i <code>y4</code>. Svaka od tih varijabli nastala je određenom transformacijom ulaza uz dodavanje određene količine šuma. Ideja zadatka jest proučiti odnos između ulazne i mogućih izlaznih varijabli te uočiti koji od tih odnosa je dobar kandidat za jednostavnu linearnu regresiju.</p>
<hr />
<p><strong>Zadatak 13.1 - uočavanje linearne povezanosti varijabli</strong></p>
<div class="sourceCode" id="cb605"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb605-1" data-line-number="1"><span class="co"># u varijablu `df` učitajte podatke iz datoteke `podaci1.csv`</span></a>
<a class="sourceLine" id="cb605-2" data-line-number="2"><span class="co"># proučite učitani podatkovni okvir</span></a>
<a class="sourceLine" id="cb605-3" data-line-number="3"></a>
<a class="sourceLine" id="cb605-4" data-line-number="4"></a>
<a class="sourceLine" id="cb605-5" data-line-number="5"><span class="co"># nacrtajte točkaste grafove odnosa varijable </span></a>
<a class="sourceLine" id="cb605-6" data-line-number="6"><span class="co"># x sa svakom pojedinom varijablom y iz gornjeg podatkovnog okvira</span></a>
<a class="sourceLine" id="cb605-7" data-line-number="7"><span class="co"># svakom grafu dodajte i geometriju zaglađivanja, metoda `lm`</span></a>
<a class="sourceLine" id="cb605-8" data-line-number="8"></a>
<a class="sourceLine" id="cb605-9" data-line-number="9"><span class="co"># odgovorite na pitanja:</span></a>
<a class="sourceLine" id="cb605-10" data-line-number="10"><span class="co"># na kojim grafovima uočavate moguću linearnu povezanost varijabli?</span></a>
<a class="sourceLine" id="cb605-11" data-line-number="11"><span class="co"># koji graf predočava nelinearnu povezanost?</span></a>
<a class="sourceLine" id="cb605-12" data-line-number="12"><span class="co"># za koji graf biste mogli reći da su varijable nezavisne?</span></a></code></pre></div>
<div class="fold s o">
<div class="sourceCode" id="cb606"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb606-1" data-line-number="1">df &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;podaci1.csv&quot;</span>, <span class="dt">stringsAsFactors =</span> F, <span class="dt">encoding =</span> <span class="st">&quot;UTF-8&quot;</span>)</a>
<a class="sourceLine" id="cb606-2" data-line-number="2">g1 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(df, <span class="kw">aes</span>(x, y1)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&#39;lm&#39;</span>) </a>
<a class="sourceLine" id="cb606-3" data-line-number="3">g2 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(df, <span class="kw">aes</span>(x, y2)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&#39;lm&#39;</span>) </a>
<a class="sourceLine" id="cb606-4" data-line-number="4">g3 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(df, <span class="kw">aes</span>(x, y3)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&#39;lm&#39;</span>) </a>
<a class="sourceLine" id="cb606-5" data-line-number="5">g4 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(df, <span class="kw">aes</span>(x, y4)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&#39;lm&#39;</span>) </a>
<a class="sourceLine" id="cb606-6" data-line-number="6"></a>
<a class="sourceLine" id="cb606-7" data-line-number="7"></a>
<a class="sourceLine" id="cb606-8" data-line-number="8"><span class="kw">grid.arrange</span>(g1, g2, g3, g4)</a></code></pre></div>
<p><img src="osnoveR_files/figure-html/unnamed-chunk-470-1.png" width="672" /></p>
</div>
<hr />
<p>Vizualizacija odnosa dvaju varijabli nam obično daje relativno dobru intuiciju kada možemo očekivati dobro funkcioniranje linearnog modela. Ukoliko želimo numerički opisati snagu linearnog odnosa dvaju varijabli, možemo se koristiti tzv. “Pearson-ovim koeficijentom korelacije” koji poprima vrijednost iz intervala [-1,1] i kod kojeg -1 znači potpunu “negativnu” korelaciju, 1 potpunu pozitivnu, a 0 da korelacije nema. U R-u ovaj koeficijent možemo dobiti uz pomoć funkcije <code>cor</code>.</p>
<p>Izračunajmo koeficijent korelacije za parove ulazne i izlaznih varijabli prikazane na grafovima iz prethodnog zadatka.</p>
<hr />
<p><strong>Zadatak 13.2 - izračun koeficijenta korelacije</strong></p>
<div class="sourceCode" id="cb607"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb607-1" data-line-number="1"><span class="co"># za svaki graf iz prethodnog zadatka izračunajte i ispišite</span></a>
<a class="sourceLine" id="cb607-2" data-line-number="2"><span class="co"># koeficijent korelacije između prikazanih varijabl (funkcija `cor`)</span></a></code></pre></div>
<div class="fold s o">
<div class="sourceCode" id="cb608"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb608-1" data-line-number="1"><span class="kw">cor</span>(df<span class="op">$</span>x, df<span class="op">$</span>y1)</a>
<a class="sourceLine" id="cb608-2" data-line-number="2"><span class="kw">cor</span>(df<span class="op">$</span>x, df<span class="op">$</span>y2)</a>
<a class="sourceLine" id="cb608-3" data-line-number="3"><span class="kw">cor</span>(df<span class="op">$</span>x, df<span class="op">$</span>y3)</a>
<a class="sourceLine" id="cb608-4" data-line-number="4"><span class="kw">cor</span>(df<span class="op">$</span>x, df<span class="op">$</span>y4)</a></code></pre></div>
<pre><code>## [1] 0.9758326
## [1] 0.6765991
## [1] -0.04977038
## [1] 0.1783745</code></pre>
</div>
<hr />
<p>Pored ove mjere za opisivanje snage linearnog odnosa često koristimo i varijablu nazvanu “koeficijent determinacije” ili - poznatije - “R kvadrat” (engl. <em>R squared</em>). Naziv ove varijable potječe od činjenice da se koeficijent korelacije kod jednostavnog linearnog modela (kojeg smo računali u prethodnom zadatku) često naziva <code>R</code>, a veličina <code>R kvadrat</code> je kod jednostavnog linearnog modela točno jednaka njezinom kvadratu. Ova veličina može poprimiti vrijednosti od 0 do 1, gdje vrijednost bliska 1 označava gotovo savršenu linearnu vezu dok vrijednost bliska 0 njezino nepostojanje.</p>
<p>Interpretacija mjere “R kvadrat” je dosta bitna te ju nije naodmet naučiti - ona se definira kao “količina varijabilnosti koja je objašnjena modelom”. Ovo možemo jednostavno objasniti na sljedeći način - gledamo omjer koliko su točke na grafu “raspršene” oko zamišljenog pravca s obzirom na njihovu “općenitu raspršenost” oko horizontalnog pravca koji bi prolazio njihovom aritmetičkom sredinom.</p>
<p>Važno je napomenuti da je “R kvadrat” jedna od važnijih kriterija za ocjenu kvalitete linearnog modela te je kao takva često sadržana u opisu rezultata modela. Usprkos tome, nema jasne granice što predstavlja “dobar” iznos ove mjere - čak i model sa malim iznosom “R kvadrata” se može pokazati korisnim, ovisno o ostalim kriterijima i konkretnom scenariju primjene.</p>
<p>Prikažimo sada kako stvaramo linearne modele u jeziku R.</p>
<hr />
</div>
<div id="funkcija-lm" class="section level3">
<h3><span class="header-section-number">13.1.2</span> Funkcija <code>lm</code></h3>
<p>U jeziku R jednostavne linearne modele stvaramo uz pomoć funkcije <code>lm</code>, što je skraćeno od <em>linear model</em>. Ova funkcija ima niz parametara, a mi ćemo koristiti najvažnije - statističku formulu i podatkovni skup na kojem treniramo:</p>
<div class="sourceCode" id="cb610"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb610-1" data-line-number="1"><span class="kw">lm</span>(formula, data)</a></code></pre></div>
<p>Pojam formule već smo objasnili u poglavlju o vizualizaciji, budući da su istu kao parametar koristili uvjetni (facetirani) grafovi. Podsjetimo se o čemu se radi - “formula” je zapravo skraćeni zapis notacije gdje želimo reći da lijeva strana formule “ovisi” o desnoj strani formule. Ako želimo trenirati linearnu regresiju ciljne varijable <code>y</code> u ovisnosti o varijabli <code>x</code> za podatkovni okvir <code>df</code> i konačni model spremiti u varijablu <code>linMod</code>, onda to u programskom kodu izgleda ovako:</p>
<div class="sourceCode" id="cb611"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb611-1" data-line-number="1">linMod &lt;-<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x, <span class="dt">data =</span> df)</a></code></pre></div>
<p>Pokušajmo ovo izvesti samostalno u sljedećem zadatku.</p>
<hr />
<p><strong>Zadatak 13.3 - stvaranje jednostavnog linearnog modela</strong></p>
<div class="sourceCode" id="cb612"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb612-1" data-line-number="1"><span class="co"># uz pomoć funkcije `lm` stvorite linearni model podataka iz tablice `df`</span></a>
<a class="sourceLine" id="cb612-2" data-line-number="2"><span class="co"># gdje je `x` ulazna a `y1` izlazna varijabla</span></a>
<a class="sourceLine" id="cb612-3" data-line-number="3"><span class="co"># rezultat spremite u varijablu `linMod`</span></a>
<a class="sourceLine" id="cb612-4" data-line-number="4"></a>
<a class="sourceLine" id="cb612-5" data-line-number="5"></a>
<a class="sourceLine" id="cb612-6" data-line-number="6"><span class="co"># ispišite varijablu `linMod`</span></a></code></pre></div>
<div class="fold s o">
<div class="sourceCode" id="cb613"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb613-1" data-line-number="1"><span class="co"># uz pomoć funkcije `lm` stvorite linearni model podataka iz tablice `df`</span></a>
<a class="sourceLine" id="cb613-2" data-line-number="2"><span class="co"># gdje je `x` ulazna a `y1` izlazna varijabla</span></a>
<a class="sourceLine" id="cb613-3" data-line-number="3"><span class="co"># rezultat spremite u varijablu `linMod`</span></a>
<a class="sourceLine" id="cb613-4" data-line-number="4">linMod &lt;-<span class="st"> </span><span class="kw">lm</span>(y1 <span class="op">~</span><span class="st"> </span>x, <span class="dt">data =</span> df)</a>
<a class="sourceLine" id="cb613-5" data-line-number="5"></a>
<a class="sourceLine" id="cb613-6" data-line-number="6"><span class="co"># ispišite varijablu `linMod`</span></a>
<a class="sourceLine" id="cb613-7" data-line-number="7">linMod</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = y1 ~ x, data = df)
## 
## Coefficients:
## (Intercept)            x  
##      46.733        3.999</code></pre>
</div>
<hr />
<p>Ispis varijable <code>linMod</code> nam ispisuje formulu koja je korištena za stvaranje modela te izračunate parametre - koeficijent smjera i odsječak (koji nam u pravilu nije interesantan). Koeficijent interpretiramo na sljedeći način - <em>za pomak od jedne jedinice ulazne varijable, izlazna se mijenja za iznos koeficijenta</em>.</p>
<p>Varijabla <code>linMod</code> iz prethodnog primjera je objekt klase <code>lm</code>. Ovo je relativno složen objekt, iako je to teško naslutiti samim ispisivanjem modela, pri čemu dobivamo samo izračunate koeficijent. Ovaj objekt zapravo sadržava ne samo koeficijente, već i bogati skup informacija vezanih uz stvoreni linearni model, što uključuje čak i sam podatkovni skup pomoću kojeg je model stvoren.</p>
<hr />
<p>Nad ovim objektom možemo izvesti sljedeće funkcije:</p>
<ul>
<li><code>coef</code> - vraća koeficijente u obliku vektora</li>
<li><code>fitted.values</code> - vraća vektor predikcija dobiven primjenom modela na skup pomoću kojeg je model stvoren</li>
<li><code>residuals</code> - vraća vektor grešaka dobiven primjenom modela na skup pomoću kojeg je model stvoren</li>
<li><code>summary</code> - daje sažetak najvažnijih informacija o modelu</li>
</ul>
<p>Isprobajmo funkciju sažetka - <code>summary</code> - nad našim linearnim modelom.</p>
<hr />
<p><strong>Zadatak 13.4 - saŽetak linearnog modela</strong></p>
<div class="sourceCode" id="cb615"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb615-1" data-line-number="1"><span class="co"># izvršite funkciju `summary` nad linearnim modelom `linMod`</span></a></code></pre></div>
<div class="fold s o">
<div class="sourceCode" id="cb616"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb616-1" data-line-number="1"><span class="kw">summary</span>(linMod)</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = y1 ~ x, data = df)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -74.010 -15.492  -1.021  15.613  77.371 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 46.73328    5.26089   8.883  3.2e-14 ***
## x            3.99851    0.09045  44.208  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 26.35 on 98 degrees of freedom
## Multiple R-squared:  0.9522, Adjusted R-squared:  0.9518 
## F-statistic:  1954 on 1 and 98 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<hr />
<p>Vidimo da smo dobili niz informacija vezanih uz naš prediktivni model. U nastavku ćemo pokušati jednostavnim jezikom, bez previše oslanjanja na znanje statistike, objasniti što nam govori veći dio dobivenih informacija.</p>
<p>Za početak uočimo da kod stvaranja linearnog modela iz nekih podataka imamo nekoliko različitih “nesigurnosti” u rezultat:</p>
<ol style="list-style-type: decimal">
<li>Da li linearni trend uopće postoji, ili se uočena kolinearnost mogla pojaviti slučajno?</li>
<li>Ako trend postoji, koliko smo sigurni da izračunati koeficijent smjera odgovara “stvarnom”?</li>
<li>Konačno, ako trend postoji a mi smo uspjeli dovoljno dobro pogoditi “pravi” koeficijent, koliko nam dodatni “šum” utječe na točnost predikcija?</li>
</ol>
<p>Prikazani sažetak nam pruža odgovor na neka od ovih pitanja.</p>
<hr />
<p>Pogledajmo prvo stupce <code>t value</code> i <code>Pr(&gt;|t|)</code>, tj. njihove vrijednosti koje se tiču naše ulazne varijable <code>x</code>. Oni odgovaraju na pitanje - da li uopće imamo dovoljno dokaza za to da postoji linearna veza između ulaza i izlaza?</p>
<p>Odgovor na ovo pitanje daje tzv. statistički <em>t - test</em>, tj. mjera jačine dokaza protiv nul-hipoteze koja tvrdi da linearna međuzavisnost ne postoji te da je koeficijent smjera pravca zapravo nula. Vrijednost pod <code>Pr(&gt;|t|)</code> je tzv. “p-vrijednost”, tj. procjena vjerojatnosti da je kolinearnost uočena slučajno, a ovdje vidimo da je ona iznimno mala. U interpretaciji nam pomaži i zvjezdice pored, čiji značaj je objašnjen u retku ispod, a koje pomažu da vizualno identificiramo koeficijente za koje smo relativno sigurni da imaju linearnu povezanost sa ciljnom varijablom.</p>
<p>Ako smo zadovoljni dokazom da koeficijent smjera nije nula, onda možemo pogledati i stupac <code>Std. Error</code> koji nam opisuje koliko smo “sigurni” u dobiveni koeficijent smjera. Statistički, uz pomoć tzv. centralnog teorema, smatramo da sa 95% sigurnošću možemo reći da je “stvarni” koeficijent u intervalu dvije standardne greške od dobivenog koeficijenta. Standardna greška ovisi o broju obzervacija u našem skupu - jednostavnim riječnikom, što više podataka imamo, to ćemo biti “sigurniji” u izračunati koeficijent.</p>
<hr />
<p>Potencijalno najzanimljivije informacije iz dobivenog sažetka su stavke <code>Residual standard error</code> i <code>Adjusted R-squared</code>.</p>
<p>Prva mjera je tzv. “standardna greška <strong>reziduala</strong>”. “Rezidual” je zapravo razlika između predikcije koju daje model i stvarne uočene vrijednosti. Standardna greška reziduala je zapravo procjena koliko (u prosjeku!) model “promašuje” kod svojih predviđanja ciljne varijable. Obzirom da je standardna greška reziduala izražena u mjernim jedinicama ciljne varijable, ona je često vrlo informativna kada pokušavamo procijeniti kvalitetu modela. naravno, procjena što uistinu smatramo “prihatljivom” pogreškom ovisi o konkretnom scenariju uporabe tj. prirodi ciljne varijable, mjernim jedinicima koje koristimo i željama tj. zahtjevima krajnjeg korisnika prediktivnog modela. Npr. ako pokušavamo procijeniti vrijednost nekretnine u milijunima kuna, pogreška od nekoliko tisuća kuna nam vjerojatno ne bi predstavljala preveliki problem; s druge strane ako pokušavamo predvidjeti koliku cijenu možemo postići prodajom starog automobila, greška u istom apsolutnom iznosu bi vjerojatno bila neprihvatljiva.</p>
<p>Razlog zašto naš model “promašuje” je tzv. “neobjašnjena varijabilnost” - sve ono što nismo mjerili a što je na neki način potencijalno utjecalo na konačni iznos ciljne varjable. Ovaj “šum”, tj. utjecaj neobjašnjene varijabilnosti nam opisuje već otprije objašnjena mjera <code>R-squared</code> (za sada nećemo previše obraćati pažnju na prefiks <code>Adjusted</code> o kojem će biti više riječi u nastavku lekcije). U idealnom slučaju naš model će imati malu standardnu grešku reziduala i visok “R kvadrat” - tj. model će i dobro pogađati i sadržavati malu količinu neobjašnjene varijabilnosti. U praksi naravno nećemo često susretati ovako idealan scenarij tako da ćemo morati za svaki pojedini slučaj uporabe često - samostalno ili u suradnji sa domenskim stručnjacima - procijeniti što smatramo “dovoljno dobrim”, budući da statistika na to pitanje nije u mogućnosti dati egzaktan odgovor.</p>
<hr />
<p>Konačno, još neki detalji koji su dobiveni u sažetku su:</p>
<ul>
<li>“sažetak 5 brojeva” (minimum, maksimum i prosjeci) reziduala koji nam pomaže u procjeni razdiobe dobivenih grešaka</li>
<li>“F-statistika” koja nam govori kolike su šanse da nijedna od ulaznih varijabli ne utječe na izlaz (ova statistika će imati više smisla kada budemo uključili više prediktorskih varijabli)</li>
</ul>
<hr />
<p>Rekli smo da linearnom regresijom dobivamo “prediktivni model”, kojeg možemo koristiti nad novim podacima kako bismo stvorili nove predikcije. Kako upotrijebiti model za stvaranje novih predikcija?</p>
<p>R nam nudi generičku metodu <code>predict</code> kojoj u općenitom slučaju kao parametre šaljemo stvoreni prediktivni model i <strong>podatkovni okvir</strong> sa novim podacima, pri čemu moramo voditi računa da podatkovni okvir ima stupce koji odgovaraju očekivanim ulazima modela. Budući da prediktivni modeli često u sebi sadrže i skup korišten za stvaranje modela, ovoj funkciji možemo proslijediti i model bez dodatnih podataka - u tom slučaju ona će nam jednostavno vratiti skup predikacija dobivenih nad originalnim skupom (tj. isti rezultat koji bi nam dala funkcija <code>fitted.values</code>).</p>
<hr />
<p><strong>Zadatak 13.5 - stvaranje novih predikcija</strong></p>
<div class="sourceCode" id="cb618"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb618-1" data-line-number="1"><span class="co"># sljedeći vektor prikazuje &quot;nove&quot; vrijednosti ulazne varijable `x`</span></a>
<a class="sourceLine" id="cb618-2" data-line-number="2">novi_x &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="op">-</span><span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">50</span>, <span class="dv">102</span>)</a>
<a class="sourceLine" id="cb618-3" data-line-number="3"></a>
<a class="sourceLine" id="cb618-4" data-line-number="4"><span class="co"># stvorite i ispišite predikcije za gornji vektor pomoću </span></a>
<a class="sourceLine" id="cb618-5" data-line-number="5"><span class="co"># funkcije `predict` i linearnog modela `linMod` linearnog modela `linMod`</span></a>
<a class="sourceLine" id="cb618-6" data-line-number="6"><span class="co"># pripazite da nove podatke šaljete u obliku podatkovnog okvira</span></a>
<a class="sourceLine" id="cb618-7" data-line-number="7"></a>
<a class="sourceLine" id="cb618-8" data-line-number="8"></a>
<a class="sourceLine" id="cb618-9" data-line-number="9"><span class="co"># izračunajte predikcije &quot;ručno&quot;, korištenjem jednadžbe pravca</span></a>
<a class="sourceLine" id="cb618-10" data-line-number="10"><span class="co"># i dobivenih koeficijenata linearnog modela</span></a></code></pre></div>
<div class="fold s o">
<div class="sourceCode" id="cb619"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb619-1" data-line-number="1"><span class="co"># stvorite i ispišite predikcije za gornji vektor pomoću </span></a>
<a class="sourceLine" id="cb619-2" data-line-number="2"><span class="co"># funkcije `predict` i linearnog modela `linMod`</span></a>
<a class="sourceLine" id="cb619-3" data-line-number="3"><span class="co"># pripazite da nove podatke šaljete u obliku podatkovnog okvira</span></a>
<a class="sourceLine" id="cb619-4" data-line-number="4"><span class="kw">predict</span>(linMod, <span class="kw">data.frame</span>(<span class="dt">x =</span> novi_x))</a>
<a class="sourceLine" id="cb619-5" data-line-number="5"></a>
<a class="sourceLine" id="cb619-6" data-line-number="6"><span class="co"># izračunajte predikcije &quot;ručno&quot;, korištenjem jednadžbe pravca</span></a>
<a class="sourceLine" id="cb619-7" data-line-number="7"><span class="co"># i dobivenih koeficijenata linearnog modela</span></a>
<a class="sourceLine" id="cb619-8" data-line-number="8"><span class="kw">coef</span>(linMod)[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>novi_x <span class="op">*</span><span class="st"> </span><span class="kw">coef</span>(linMod)[<span class="dv">2</span>] </a></code></pre></div>
<pre><code>##         1         2         3         4 
##  26.74074  86.71835 246.65864 454.58101 
## [1]  26.74074  86.71835 246.65864 454.58101</code></pre>
</div>
<hr />
<p>Analitičari se često ne žele osloniti samo na sažete rezultate koji opisuju dobiveni model, već žele dodatno procijeniti kvalitetu modela kroz različite vizualizacije. Analitičara često zanima ponašanje grešaka, tj. reziduala. Naime, ako je linearni model dobro opisao podatke, onda nakon povlačenja pravca kroz obzervacije očekujemo da se točke jednoliko raspršuju oko pravca, bez nekih očitih uzoraka. Npr. ako pogledamo ovisnost varijable <code>y3</code> o varijabli <code>x</code> u grafu na početku ove lekcije, vidimo jasan uzorak grešaka gdje parabolična priroda odnosa rezulitra jasno uočljivom uzorkom gdje pravac prvo prolazi iznad skupa obzervacija, potom ispod i konačno opet iznad - što nam jasno govori da linearni model loše objašnjava odnos ovih dvaju varijabli.</p>
<p>Dakle, dva pitanja koje analitičar potencijalno može postaviti vezano uz reziduale su:</p>
<ul>
<li>da li postoje očiti uzorci u ponašanju reziduala obzirom na slijed originalnih obzervacija i</li>
<li>da li reziduali imaju normalnu razdiobu</li>
</ul>
<p>Na prvo pitanje nam odgovor mogu dati vizualizacije koje koriste sljedeće geometrije paketa <code>ggplot2</code>:</p>
<ul>
<li><code>geom_point</code> - “običan” točkasti graf sa prediktorima na osi x i rezidualima na osi y
<ul>
<li>očekujemo “oblak” reziduala bez očitih uzoraka</li>
</ul></li>
<li><code>geom_density</code> - geometrija koja crta procijenjenu funkciju gustoće varijable
<ul>
<li>normalna razdioba reziduala imati će zvonasti oblik, bez uočljivih “repova”</li>
</ul></li>
<li><code>geom_qq</code> - geometrija koja crta tzv. QQ (<em>quantile-quantile</em> graf)
<ul>
<li>normalna razdioba na ovom grafu ima oblik pravca</li>
</ul></li>
</ul>
<p>Prije stvaranja ovih vizualizacija nailazimo na nezgodan problem - paket <code>ggplot2</code> podrazumijeva postojanje podatkovnog okvira sa varijablama koje želimo prikazati, no mi nemamo podatkovni okvir sa rezidualima! Naime, već smo rekli da su originalni podaci, predikcije i reziduali sadržani u linearnom modelu, no jezik R nam ne daje jednostavan način da te informacije i dobijemo u obliku podatkovnog okvira - možemo im pristupiti preko funkcija kao što su <code>fitted.values</code> za predikcije, <code>residuals</code> za reziduale, no onda moramo “ručno” slagati podatkovni okvir prije nego ga možemo vizualizirati, što predstavlja dodatan posao kojeg bismo radije izbjegli.</p>
<p>U pomoć nam stiže paket <code>broom</code>, čiji je jedan od autora i Hadley Wickham, kojeg smo već upoznali kao programera paketa <code>dplyr</code> i <code>ggplot2</code>. Paket <code>broom</code> nudi niz funkcija za uređivanje dobivenih prediktivnih modela i lako izvlačenje informacija iz istih - npr. funkcija <code>tidy</code> nam daje rezultate modela (tj. koeficijente) složene u lako čitljiv podatkovni okvir, dok nam funkcija <code>glance</code> radi isto ali nad parametrima koji opisuju kvalitetu modela.</p>
<p>Mi ćemo se u nastavku poslužiti metodom <code>augment</code> koja na osnovu prosljeđenog prediktivnog modela vraća originalni podatkovni okvir korišten za stvaranje modela, ali proširen sa nizom korisnih stupaca kao što su:</p>
<ul>
<li><code>.fitted</code> - predikcije dobivene primjenom modela</li>
<li><code>.se.fit</code> - standardna greška pojedine predikcije</li>
<li><code>.resid</code> - iznos reziduala, tj. greške</li>
<li><code>.std.resid</code> - reziduali standardizirani na interval [0,1]</li>
<li><code>.hat</code> - mjera “ekstremnosti” ulazne varijable obzervacije (engl. <em>leverage</em>);</li>
<li><code>.cooksd</code> - mjera “utjecajnosti” obzervacije (engl. <em>influential point</em>) na model</li>
</ul>
<p>Obzervacije sa visokom <em>leverage</em> mjerom su potencijalne iskočnice (engl. <em>outlier</em>-i) te kao takve zaslužuju dodatnu pažnju. Posebno su nam problematične obzervacije sa visokom “utjecajnosti” na model - to su obzervacije koje imaju i visoku mjeru <em>leverage</em> i veliku grešku (rezidual). Ovakve obzervacije mogu snažno “odvući” pravac prema sebi i time pokvariti kvalitetu modela.</p>
<p>Primjenimo funkciju <code>augment</code> nad našim prediktivnim modelom.</p>
<hr />
<p><strong>Zadatak 13.6 - funkcija <code>augment</code> paketa <code>broom</code></strong></p>
<div class="sourceCode" id="cb621"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb621-1" data-line-number="1"><span class="co"># primjenite funkciju `augment` nad linearnim modelom `linMod`</span></a>
<a class="sourceLine" id="cb621-2" data-line-number="2"><span class="co"># rezultantni podatkovni okvir pohranite u varijablu `predikcije`</span></a>
<a class="sourceLine" id="cb621-3" data-line-number="3"></a>
<a class="sourceLine" id="cb621-4" data-line-number="4"><span class="co"># proučite prvih nekoliko redaka okvira `predikcije`</span></a></code></pre></div>
<div class="fold s o">
<div class="sourceCode" id="cb622"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb622-1" data-line-number="1"><span class="co">#library(broom)   # ako je potrebno</span></a>
<a class="sourceLine" id="cb622-2" data-line-number="2">predikcije &lt;-<span class="st"> </span><span class="kw">augment</span>(linMod)</a>
<a class="sourceLine" id="cb622-3" data-line-number="3"><span class="kw">head</span>(predikcije)</a></code></pre></div>
<pre><code>## # A tibble: 6 x 9
##      y1     x .fitted .se.fit .resid   .hat .sigma  .cooksd .std.resid
##   &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;    &lt;dbl&gt;      &lt;dbl&gt;
## 1 391.   83.8   382.     4.01   9.43 0.0232   26.5 0.00156       0.362
## 2 254.   48.5   241.     2.64  13.1  0.0100   26.5 0.00126       0.499
## 3  84.1  10.5    88.8    4.46  -4.71 0.0287   26.5 0.000485     -0.181
## 4 144.   33.4   180.     3.05 -36.4  0.0134   26.2 0.0131       -1.39 
## 5 295.   74.6   345.     3.43 -49.8  0.0170   26.0 0.0313       -1.91 
## 6 148.   36.7   193.     2.91 -45.0  0.0122   26.1 0.0183       -1.72</code></pre>
</div>
<p>(NAPOMENA: metodu <code>augment</code> možemo koristiti i kao alternativu generičkoj metodi <code>predict</code> - samo joj moramo proslijediti nove podatke uz pomoć parametra <code>newdata</code>)</p>
<hr />
<p>Sada kada imamo podatkovni okvir koji sadrži podatke o rezidualima, možemo stvoriti spomenute vizualizacije. Konkretno, stvoriti ćemo</p>
<ul>
<li>točkasti graf sa predikcijama na osi <code>x</code> i (standardiziranim) rezidualima na osi <code>y</code></li>
<li>graf funkcije gustoće razdiobe standardiziranih reziduala</li>
<li>kvantil-kvantil graf standardiziranih reziduala</li>
</ul>
<p>Razlog zašto radimo sa standardiziranim umesto “pravim” rezidualima jest samo lakša interpretacija, tj. jednostavnija usporedba rezultata sa “standardnom” normalnom razdiobom koja ima sredinu 0 i standardnu devijaciju 1.</p>
<hr />
<p><strong>Zadatak 13.7 - provjera ‘normalnosti’ reziduala</strong></p>
<div class="sourceCode" id="cb624"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb624-1" data-line-number="1"><span class="co"># uz pomoć podatkovnog okvira `predikcije`</span></a>
<a class="sourceLine" id="cb624-2" data-line-number="2"><span class="co"># stvorite točkasti graf predikcija i std. reziduala</span></a>
<a class="sourceLine" id="cb624-3" data-line-number="3"><span class="co"># na grafu nacrtajte i horizontalnu liniju koja prolazi kroz nulu</span></a>
<a class="sourceLine" id="cb624-4" data-line-number="4"></a>
<a class="sourceLine" id="cb624-5" data-line-number="5"><span class="co"># stvorite graf gustoće razdiobe standardnih reziduala</span></a>
<a class="sourceLine" id="cb624-6" data-line-number="6"><span class="co"># koristite geometriju `geom_density`</span></a>
<a class="sourceLine" id="cb624-7" data-line-number="7"></a>
<a class="sourceLine" id="cb624-8" data-line-number="8"><span class="co"># stvorite kvantil-kvantil graf std. reziduala</span></a>
<a class="sourceLine" id="cb624-9" data-line-number="9"><span class="co"># koristite geometriju `geom_qq`</span></a>
<a class="sourceLine" id="cb624-10" data-line-number="10"><span class="co"># reziduale postavite na estetiku `sample` (ne `x`!)</span></a></code></pre></div>
<div class="fold s o">
<div class="sourceCode" id="cb625"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb625-1" data-line-number="1"><span class="co">#library(gridExtras)  # ako je potrebno</span></a>
<a class="sourceLine" id="cb625-2" data-line-number="2">g1 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(predikcije, <span class="kw">aes</span>(.fitted, .std.resid)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb625-3" data-line-number="3"><span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">0</span>, <span class="dt">color =</span> <span class="st">&quot;blue&quot;</span>)</a>
<a class="sourceLine" id="cb625-4" data-line-number="4">g2 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(predikcije, <span class="kw">aes</span>(<span class="dt">x =</span> .std.resid)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_density</span>()</a>
<a class="sourceLine" id="cb625-5" data-line-number="5">g3 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(predikcije, <span class="kw">aes</span>(<span class="dt">sample =</span> .std.resid)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_qq</span>()</a>
<a class="sourceLine" id="cb625-6" data-line-number="6"><span class="kw">grid.arrange</span>(g1, g2, g3, <span class="dt">ncol =</span> <span class="dv">2</span>)</a></code></pre></div>
<p><img src="osnoveR_files/figure-html/unnamed-chunk-484-1.png" width="672" /></p>
</div>
<hr />
<p>U našem (umjetno stvorenom) primjeru dobili smo vrlo uvjerljive argumente da linearni model koji smo dobili vrlo dobro opisuje odnos varijabli te je kao takav vjerojatno dobar izbor za stvaranje predikcija. U realnoj praksi često nećemo dobiti ovako “čiste” rezultate te ćemo morati dobro procijeniti da li je model dovoljno dobar, da li je potreban dodatni rad nad podacima ili procesu izgradnje modela, ili je potrebno odabrati potpuno novi pristup. Za primjer, neki od mogućih zaključaka nakon stvaranja vizualizacija reziduala mogu biti sljedeći:</p>
<ul>
<li>ako točkasti graf sa predikcijama i rezidualima pokazuje očite uzorke, moguće da linearni model nije dobar za opis odnosa prediktora i cilja te treba posegnuti za modelom koji može opisati složeniju prirodu odnosa</li>
<li>ako graf reziduala ima oblik “lijevka”, tj. ako reziduali rastu sa povećanjem vrijednosti predikcija, možda je potrebno transformirati ulazne i/ili izlazne varijable, npr. uz pomoć funkcije korijena ili logaritma</li>
<li>ako uočavamo neke vrijednosti koje izrazito “iskaču” u grafu reziduala trebamo ih pažljivije pogledati i potencijalno ukloniti iz skupa za stvaranje modela</li>
</ul>
<p>Još jedna od stvari koje analitičar može isprobati jest nacrtati graf reziduala redoslijedom kako su obzervacije dobivene u originalnom skupu (točkasti graf gdje je na osi x redni broj obzervacije a na y rezidual). Ukoliko se uoči visoka razina međuovisnosti reziduala koji su blizu jedan drugom, moguće je da naši podaci zapravo predstavljaju “vremenski niz” (engl. <em>time series data</em>). Za ovakve podatke ne bismo smjeli koristiti linearnu regresiju, već koristiti naprednije, specijalizirane metode namjenjene baš vremenskim nizovima, kao što je npr. ARIMA (engl. <em>autoregressive integrated moving average</em>).</p>
<hr />
</div>
<div id="linearna-regresija-i-kategorijske-varijable" class="section level3">
<h3><span class="header-section-number">13.1.3</span> Linearna regresija i kategorijske varijable</h3>
<hr />
<p>U prethodnom poglavlju prikazali smo razvoj prediktivnog modela linearne regresije gdje je ulazna varijabla bila numeričkog tipa. Opravdano je zapitati se - može li kategorijska varijabla biti ulaz u prediktivni model?</p>
<p>Odgovor je - može, uz određenu prilagodbu. Prikažimo kako na jednostavnom primjeru dvorazinske kategorijske varijable, što kasnije lako proširujemo na varijable sa više od dvije kategorije.</p>
<p>Kategorijska varijabla prema svojoj prirodi ne može biti dio jednadžbe pravca, budući da kategorija sama po sebi nema numerički ekvivalent koji bi se mogao smisleno koristiti za izračun ciljne varijable. No ono što možemo učiniti jest pretvoriti kategorijsku varijablu u binarnu (indikatorsku) varijablu koja opisuje pripada li određena obzervacija odabranoj kategoriji (ako ne pripada, onda logično pripada onoj drugoj, referentnoj ili <em>baseline</em> kategoriji). Linearna regresija će potom odrediti koeficijent koji će definirati pravac na način da se koeficijent pribraja ako je indikatorska varijabla <code>1</code>, ili se ne uzima u obzir ako je indikatorska varijabla <code>0</code>.</p>
<hr />
<p>Za dvorazinsku kategorijsku varijablu dovoljna nam je jedna indikatorska varijabla - druga bi bila komplement prve i ne bi nosila nikakvu dodatnu informaciju. Koliko nam treba indikatorskih varijabli za kategorijsku varijablu sa više od dvije kategorije? Odgovor je logičan - jedna manje od broja kategorija, budući da “nepripadanje” svim kategorijama osim jedne nužno označava pripadanje toj jednoj, preostaloj kategoriji. Ovdje možemo napomenuti da ponekad možemo napraviti po jednu indikatorsku varijabli za svaku kategoriju, ukoliko želimo, no onda moramo biti sigurni da postojanjem jednog redundantnog stupca neće negativno utjecati na model. Linearna regresija je jedna od metoda koja je osjetljiva na ovakve redundantne stupce, zbog čega ćemo ih ovdje izbjegavati.</p>
<p>U nastavku ćemo prikazati linearnu regresiju sa dvorazinskom kategorijskom varijablom, budući da se tu zapravo radi o inačici jednostavne linearne regresije. Za veći broj kategorija problem se svodi na višestruku linearnu regresiju koju ćemo obrađivati nakon ovog poglavlja.</p>
<p>Učitajmo sada novi, također umjetno stvoreni podatkovni okvir, sa jednom dvorazinskom kategorijskom varijablom <code>x</code> koja predstavlja ulaz te ciljnom numeričkom varijablom <code>y</code>.</p>
<hr />
<p><strong>Zadatak 13.8 - podatkovni okvir sa kategorijskim prediktorom</strong></p>
<div class="sourceCode" id="cb626"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb626-1" data-line-number="1"><span class="co"># u varijablu `df` učitajte podatke iz datoteke `podaci2.csv`</span></a>
<a class="sourceLine" id="cb626-2" data-line-number="2"><span class="co"># proučite učitani podatkovni okvir</span></a>
<a class="sourceLine" id="cb626-3" data-line-number="3"></a>
<a class="sourceLine" id="cb626-4" data-line-number="4"><span class="co"># nacrtajte točkasti graf ovisnosti varijable `y` o varijabli `x`</span></a></code></pre></div>
<div class="fold s o">
<div class="sourceCode" id="cb627"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb627-1" data-line-number="1"><span class="co"># u varijablu `df` učitajte podatke iz datoteke `podaci2.csv`</span></a>
<a class="sourceLine" id="cb627-2" data-line-number="2"><span class="co"># proučite učitani podatkovni okvir</span></a>
<a class="sourceLine" id="cb627-3" data-line-number="3">df &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;podaci2.csv&quot;</span>)</a>
<a class="sourceLine" id="cb627-4" data-line-number="4"><span class="kw">glimpse</span>(df)</a></code></pre></div>
<pre><code>## Observations: 100
## Variables: 2
## $ x &lt;fct&gt; B, B, A, B, B, B, A, A, A, B, B, A, A, B, B, B, B, B, A, B, ...
## $ y &lt;dbl&gt; 63.61392, 63.91110, 20.24407, 95.70271, 56.93969, 78.36473, ...</code></pre>
</div>
<div class="fold s o">
<div class="sourceCode" id="cb629"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb629-1" data-line-number="1"><span class="co"># nacrtajte točkasti graf ovisnosti varijable `y` o varijabli `x`</span></a>
<a class="sourceLine" id="cb629-2" data-line-number="2"><span class="kw">ggplot</span>(df, <span class="kw">aes</span>(x, y)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>() </a></code></pre></div>
<p><img src="osnoveR_files/figure-html/unnamed-chunk-489-1.png" width="672" /></p>
</div>
<hr />
<p>Vidimo da je razdioba ciljne varijable različita za različite kategorije ulazne varijable. Ovaj porast možemo modelirati linearnom regresijom, iako će interpretacija modela biti nešto drugačija s obzirom na intepretaciju numeričkih ulaza, kako ćemo vidjeti nakon izgradnje samog modela.</p>
<p>Jedna od prednosti korištenja faktorskih varijabli u jeziku R jest ta što kod treniranja linearnih modela ne moramo “ručno” stvarati indikatorske varijable. Mi samo trebamo staviti faktore kao ulazne varijable u formulu za treniranje modela, a R će automatski stvoriti indikatorske varijable za nas (ovo vrijedi i za stvaranje predikcija jednom kad je model stvoren - pod uvjetom da faktori u novim podacima ne sadržavaju “nepoznate” kategorije).</p>
<hr />
<p><strong>Zadatak 13.9 - stvaranje linearnog modela sa kategorijskim ulazom</strong></p>
<div class="sourceCode" id="cb630"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb630-1" data-line-number="1"><span class="co"># uz pomoć funkcije `lm` stvorite linearni model podataka iz tablice `df`</span></a>
<a class="sourceLine" id="cb630-2" data-line-number="2"><span class="co"># gdje je `x` ulazna a `y` izlazna varijabla</span></a>
<a class="sourceLine" id="cb630-3" data-line-number="3"><span class="co"># rezultat spremite u varijablu `linMod`</span></a></code></pre></div>
<div class="fold s o">
<div class="sourceCode" id="cb631"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb631-1" data-line-number="1">linMod &lt;-<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x, <span class="dt">data =</span> df)</a>
<a class="sourceLine" id="cb631-2" data-line-number="2"><span class="kw">summary</span>(linMod)</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = y ~ x, data = df)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -19.206  -6.104  -1.367   5.523  28.665 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   20.493      1.398   14.66   &lt;2e-16 ***
## xB            55.652      1.938   28.71   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 9.684 on 98 degrees of freedom
## Multiple R-squared:  0.8938, Adjusted R-squared:  0.8927 
## F-statistic: 824.4 on 1 and 98 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<p>Vidimo da je sažetak linearnog modela vrlo sličan već prikazanom sažetku gdje je ulazna varijabla bila numeričkog tipa. Razlika u interpretaciji je sljedeća - koeficijent smjera veže se uz konkretnu kategoriju (navedenu uz ime varijable), a tiče se očekivane razlike u iznosu ciljne varijable kad obzervacija ima navedenu kategoriju, u odnosu na referentnu kategoriju.</p>
<p>Za kraj ovog dijela naglasimo samo da je kod korištenja kategorijskih varijabli kao ulaze u linearni model bitno voditi računa o zastupljenosti kategorija, tj. da nemamo kategorije koje su vrlo slabo zastupljene u podatkovnom skupu za treniranje. Razlog je taj što ovakve obzervacije vrlo često imaju veliki utjecaj na regresijski pravac, a što može imati nepovoljne posljedice na kvalitetu linearnog modela.</p>
<hr />
</div>
</div>
<div id="visestruka-multipla-linearna-regresija" class="section level2">
<h2><span class="header-section-number">13.2</span> Višestruka (multipla) linearna regresija</h2>
<hr />
<p>Princip jednostavne linearne regresije lako se proširuje na scenarij kada imamo više ulaznih varijabli - jednostavno rečeno, tražimo funkciju koja će ciljnu varijablu izraziti kao linearnu kombinaciju ulaznih varijabli. Problem izgradnje modela opet se svodi na traženje “dobrih” koeficijenata smjera koji će ići uz svaku ulaznu varijablu (plus odsječak), iako formalno sada ne možemo pričati o “pravcu” regresije već se radi o nešto kompleksnijem pojmu “hiper-ravnine”.</p>
<p>Kod višestruke linearne regresije pojavljuje se niz dodatnih izazova s kojima se moramo suočiti, no za samo treniranje modela koristimo već upoznatu funkciju <code>lm</code>, kojoj je dovoljno proslijediti željenu formulu, npr:</p>
<div class="sourceCode" id="cb633"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb633-1" data-line-number="1">y <span class="op">~</span><span class="st"> </span>x1 <span class="op">+</span><span class="st"> </span>x2              <span class="co"># `y` kao linearna kombinacija `x1` i `x2`</span></a>
<a class="sourceLine" id="cb633-2" data-line-number="2">y <span class="op">~</span><span class="st"> </span>.                    <span class="co"># `y` kao linearna kombinacija svih ostalih varijabli</span></a>
<a class="sourceLine" id="cb633-3" data-line-number="3">y <span class="op">~</span><span class="st"> </span>. <span class="op">-</span><span class="st"> </span>x1 <span class="op">-</span><span class="st"> </span>x2          <span class="co"># `y` kao linearna kombinacija svih ostalih varijabli OSIM x1 i x2</span></a>
<a class="sourceLine" id="cb633-4" data-line-number="4"><span class="kw">log</span>(y)  <span class="op">~</span><span class="st"> </span>x1 <span class="op">+</span><span class="st"> </span><span class="kw">log</span>(x2)   <span class="co">#  prirodni logaritam od `y` kao linearna kombinacija `x1` i</span></a>
<a class="sourceLine" id="cb633-5" data-line-number="5">                              <span class="co"># prirodnog logaritma od `x2`</span></a>
<a class="sourceLine" id="cb633-6" data-line-number="6">y <span class="op">~</span><span class="st"> </span>x1 <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(x2<span class="op">^</span><span class="dv">2</span>)         <span class="co"># `y` kao linearna kombinacija `x1` i kvadrata od `x2`</span></a></code></pre></div>
<p>Uočimo da formula može sadržavati i transformirane ulaze (i izlaze!). Ovdje moramo biti u izvjesnoj mjeri oprezni jer se ponekad matematička notacija “sukobljava” sa notacijom formule (npr. vidimo da <code>-</code> zapravo nije aritmetičko oduzimanje već metoda određivanja nepoželjne varijable). Zbog toga smo u zadnjem primjeru koristili funkciju <code>I</code>, koja jednostavno označava da se izraz između zagrada treba tretirati “onakav kakav je”.</p>
<p>Prikazanim transformacijama ulaza i izlaza udaljavamo se od jednostavnijih modela linearne regresije sa više ulaza tako da ih u nastavku nećemo koristiti. Ovdje ih navodimo samo iz razloga potpunosti te kao motivaciju za isprobavanje složenijih regresijskih formula u situacijama kada se ukaže potreba za takvim pristupom.</p>
<p>Pokušajmo sada stvoriti prediktivni model sa više ulaznih varijabli. U zadatku ćemo koristiti otprije upoznati podatkovni skup <code>mtcars</code> (ako je potrebno podsjetite se dodatnih detalja o ovom skupu uz pomoć dokumentacije).</p>
<hr />
<div class="sourceCode" id="cb634"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb634-1" data-line-number="1"><span class="kw">data</span>(mtcars)</a>
<a class="sourceLine" id="cb634-2" data-line-number="2"><span class="co"># faktoriziramo stupce  `vs` i `am`</span></a>
<a class="sourceLine" id="cb634-3" data-line-number="3">cols &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;vs&quot;</span>, <span class="st">&quot;am&quot;</span>)</a>
<a class="sourceLine" id="cb634-4" data-line-number="4">mtcars[, cols] &lt;-<span class="st"> </span><span class="kw">lapply</span>(mtcars[, cols], factor)</a>
<a class="sourceLine" id="cb634-5" data-line-number="5"></a>
<a class="sourceLine" id="cb634-6" data-line-number="6"><span class="kw">glimpse</span>(mtcars)</a></code></pre></div>
<pre><code>## Observations: 32
## Variables: 11
## $ mpg  &lt;dbl&gt; 21.0, 21.0, 22.8, 21.4, 18.7, 18.1, 14.3, 24.4, 22.8, 19....
## $ cyl  &lt;dbl&gt; 6, 6, 4, 6, 8, 6, 8, 4, 4, 6, 6, 8, 8, 8, 8, 8, 8, 4, 4, ...
## $ disp &lt;dbl&gt; 160.0, 160.0, 108.0, 258.0, 360.0, 225.0, 360.0, 146.7, 1...
## $ hp   &lt;dbl&gt; 110, 110, 93, 110, 175, 105, 245, 62, 95, 123, 123, 180, ...
## $ drat &lt;dbl&gt; 3.90, 3.90, 3.85, 3.08, 3.15, 2.76, 3.21, 3.69, 3.92, 3.9...
## $ wt   &lt;dbl&gt; 2.620, 2.875, 2.320, 3.215, 3.440, 3.460, 3.570, 3.190, 3...
## $ qsec &lt;dbl&gt; 16.46, 17.02, 18.61, 19.44, 17.02, 20.22, 15.84, 20.00, 2...
## $ vs   &lt;fct&gt; 0, 0, 1, 1, 0, 1, 0, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 1, 1, ...
## $ am   &lt;fct&gt; 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, ...
## $ gear &lt;dbl&gt; 4, 4, 4, 3, 3, 3, 3, 4, 4, 4, 4, 3, 3, 3, 3, 3, 3, 4, 4, ...
## $ carb &lt;dbl&gt; 4, 4, 1, 1, 2, 1, 4, 2, 2, 4, 4, 3, 3, 3, 4, 4, 4, 1, 2, ...</code></pre>
<hr />
<p><strong>Zadatak 13.10 - stvaranje linearnog modela sa više prediktora</strong></p>
<div class="sourceCode" id="cb636"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb636-1" data-line-number="1"><span class="co"># uz pomoć funkcije `lm` stvorite linearni model podataka iz tablice `mtcars`</span></a>
<a class="sourceLine" id="cb636-2" data-line-number="2"><span class="co"># koristite varijable `am`,  `cyl` i `wt` kao ulaz</span></a>
<a class="sourceLine" id="cb636-3" data-line-number="3"><span class="co"># i varijablu `mpg` kao izlaz</span></a>
<a class="sourceLine" id="cb636-4" data-line-number="4"><span class="co">#</span></a>
<a class="sourceLine" id="cb636-5" data-line-number="5"><span class="co"># proučite sažetak modela</span></a></code></pre></div>
<div class="fold s o">
<div class="sourceCode" id="cb637"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb637-1" data-line-number="1">linMod &lt;-<span class="st"> </span><span class="kw">lm</span>(mpg <span class="op">~</span><span class="st"> </span>am <span class="op">+</span><span class="st"> </span>cyl <span class="op">+</span><span class="st"> </span>wt, <span class="dt">data =</span> mtcars)</a>
<a class="sourceLine" id="cb637-2" data-line-number="2"><span class="kw">summary</span>(linMod)</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = mpg ~ am + cyl + wt, data = mtcars)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -4.1735 -1.5340 -0.5386  1.5864  6.0812 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  39.4179     2.6415  14.923 7.42e-15 ***
## am1           0.1765     1.3045   0.135  0.89334    
## cyl          -1.5102     0.4223  -3.576  0.00129 ** 
## wt           -3.1251     0.9109  -3.431  0.00189 ** 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 2.612 on 28 degrees of freedom
## Multiple R-squared:  0.8303, Adjusted R-squared:  0.8122 
## F-statistic: 45.68 on 3 and 28 DF,  p-value: 6.51e-11</code></pre>
</div>
<hr />
<p>Vidimo da se niti ovaj sažetak naizgled ne razlikuje od sažetaka koje smo viđali kada smo radili jednostavne linearne modele. Najveća razlika jest u tome što je svaka ulazna numerička varijabla dobija svoj pripadajući koeficijent, kao i svaka kategorija osim referentne za svaku pojedinu kategorijsku varijablu. Isto tako, svaki koeficijent ima svoju vlastitu “p-vrijednost” tj. vjerojatnost da je linearni odnos sa ciljnom varijablom slučajan - tako u ovom slučaju zbog visoke p-vrijednosti ulazne varijable <code>am</code> (kategorija <code>1</code>) možemo zaključiti je razlika između automatskog i ručnog mjenjača vrlo vjerojatno nebitna kad gledamo potrošnju automobila, što i nije nečekivan zaključak).</p>
<p>No postoji i nekoliko bitnih razlika u interpretaciji dobivenih rezultata. Tako recimo koeficijent predstavlja pomak ciljne varijable za jednu jedinicu ulazne varijable, <em>ali pod uvjetom da svi ostali ulazni parametri ostaju fiksni</em>. Drugim riječima, koeficijenti se tretiraju kao da su nezavisni jedni od drugih. Naravno, ova pretpostavka često nije slučaj u stvarnom svijetu, a kako ova činjenica utječe na rezultate je nešto o čemu će više riječi biti kasnije.</p>
<hr />
<p>Pogledajmo sada mjeru “R-kvadrat”.Iako ova mjera ima jednaku interpretaciju za višestruku regresiju kao i u slučaju jednostavne regresije, ona može biti ponešto problematična zbog činjenice da se višestruka R-kvadrat vrijednost u pravilu <strong>uvijek smanjuje kako dodajemo varijable u model</strong>. Zbog toga kod višestruke regresije radije gledamo <strong>prilagođenu</strong> R-kvadrat vrijednost (engl. <em>adjusted R-squared</em>) koja to kompenzira, tj. koja je smišljena tako da uvodi dodatne “penale” za veći broj varijabli.</p>
<p>Konačno, F-statistika ovdje ima više smisla nego u modelu jednostavne regresije. Ona nam govori kolika je šansa da nijedna ulazna varijabla nije povezana sa ciljnom. Ovo pogotovo postaje važno što više ulaznih varijabli koristimo - ako pretpostavimo iznimno veliki broj ulaznih varijabli, mogućnost slučajnog uočavanja nepostojećeg odnosa postaje nezanemariva, a ova statistika nam omogućuje da procijenimo koliko je izvjesno da do takve situacije dođe.</p>
<hr />
<p>Vratimo se navedenoj tvrdnji da koeficijenti višestruke linearne regresije tretiraju ulazne varijable kao da su nezavisne jedna od druge. To relativno često nije slučaj tj. ulazne varijable nisu samo kolinearne sa ciljem, nego i između sebe. Ovo je poznati problem <em>kolinearnosti ulaznih varijabli</em>.</p>
<p>Ako možda nije odmah jasno zašto je ovo problematično, dovoljno je ponovo pogledati interpretaciju koeficijenata višestruke linearne regresije. Model pretpostavlja da možemo odabrati jedan prediktor i slobodno ga mijenjati dok vrijednosti ostalih prediktora ostaju fiksne. Pretpostavimo sada da su dva prediktora iznimno kolinearna, tj. da promjena jednog uvijek rezultira promjenom drugog. To znači da model pretpostavlja puno veći broj kombinacija vrijednosti ova dva prediktora nego što je on realno moguć, a budući da veliki broj tih kombinacija ne postoji u ulaznom skupu, to rezultira nuspojavom veće “nesigurnosti” modela u dobivene rezultate. Konkretno, izračunate p-vrijednosti prediktora mogu biti prilično velike do razine da one mogu biti tretirane kao irelevantne, iako su zapravo snažno linearno povezane s ciljem.</p>
<p>Što možemo učiniti vezano uz ovu pojavu? Kao prvo, kolinearnost ulaznih varijabli možemo direktno provjeriti uz pomoć već korištene funkcije <code>cor</code>, koja će nam kao rezultat dati korelacijsku matricu. Čvrste granice što predstavlja “previsoku” kolinearnost nema, ali vrijednosti koje su po apsolutnom iznosu iznad 0.7 vjerojatno zaslužuju posebnu pažnju. Alternativno, možemo pozvati funkciju <code>ggpairs</code> koja će nam dati iznose koeficijenta korelacije, ali i vizualizacije pomoću kojih možemo uočiti linearne trendove između ulaznih varijabli.</p>
<hr />
<p><strong>Zadatak 13.11 - kolinearnost ulaznih varijabli</strong></p>
<div class="sourceCode" id="cb639"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb639-1" data-line-number="1"><span class="co"># u podatkovni okvir `mtCarsNumPred` ubacite sve numeričke</span></a>
<a class="sourceLine" id="cb639-2" data-line-number="2"><span class="co"># varijable podatkovnog okvira `mtcars` osim ciljne varijable `mpg`</span></a>
<a class="sourceLine" id="cb639-3" data-line-number="3"></a>
<a class="sourceLine" id="cb639-4" data-line-number="4"><span class="co"># uz pomoć funkcije `cor` ispišite korelacijsku matricu</span></a>
<a class="sourceLine" id="cb639-5" data-line-number="5"><span class="co"># stupaca okvira `mtCarsNumPred`</span></a>
<a class="sourceLine" id="cb639-6" data-line-number="6"></a>
<a class="sourceLine" id="cb639-7" data-line-number="7"><span class="co"># proslijedite taj okvir funkciji `ggpairs` paketa `GGally`</span></a></code></pre></div>
<div class="fold s o">
<div class="sourceCode" id="cb640"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb640-1" data-line-number="1"><span class="co"># u podatkovni okvir `mtCarsNumPred` ubacite sve numeričke</span></a>
<a class="sourceLine" id="cb640-2" data-line-number="2"><span class="co"># varijable podatkovnog okvira `mtcars` osim ciljne varijable `mpg`</span></a>
<a class="sourceLine" id="cb640-3" data-line-number="3">mtcars <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(<span class="op">-</span>mpg) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select_if</span>(is.numeric) -&gt;<span class="st"> </span>mtCarsNumPred</a>
<a class="sourceLine" id="cb640-4" data-line-number="4"></a>
<a class="sourceLine" id="cb640-5" data-line-number="5"><span class="co"># uz pomoć funkcije `cor` ispišite korelacijsku matricu</span></a>
<a class="sourceLine" id="cb640-6" data-line-number="6"><span class="co"># stupaca okvira `mtCarsNumPred`</span></a>
<a class="sourceLine" id="cb640-7" data-line-number="7">mtCarsNumPred <span class="op">%&gt;%</span><span class="st"> </span>cor</a></code></pre></div>
<pre><code>##             cyl       disp         hp        drat         wt        qsec
## cyl   1.0000000  0.9020329  0.8324475 -0.69993811  0.7824958 -0.59124207
## disp  0.9020329  1.0000000  0.7909486 -0.71021393  0.8879799 -0.43369788
## hp    0.8324475  0.7909486  1.0000000 -0.44875912  0.6587479 -0.70822339
## drat -0.6999381 -0.7102139 -0.4487591  1.00000000 -0.7124406  0.09120476
## wt    0.7824958  0.8879799  0.6587479 -0.71244065  1.0000000 -0.17471588
## qsec -0.5912421 -0.4336979 -0.7082234  0.09120476 -0.1747159  1.00000000
## gear -0.4926866 -0.5555692 -0.1257043  0.69961013 -0.5832870 -0.21268223
## carb  0.5269883  0.3949769  0.7498125 -0.09078980  0.4276059 -0.65624923
##            gear       carb
## cyl  -0.4926866  0.5269883
## disp -0.5555692  0.3949769
## hp   -0.1257043  0.7498125
## drat  0.6996101 -0.0907898
## wt   -0.5832870  0.4276059
## qsec -0.2126822 -0.6562492
## gear  1.0000000  0.2740728
## carb  0.2740728  1.0000000</code></pre>
</div>
<div class="fold s o">
<div class="sourceCode" id="cb642"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb642-1" data-line-number="1"><span class="co"># proslijedite taj okvir funkciji `ggpairs` paketa `GGally`</span></a>
<a class="sourceLine" id="cb642-2" data-line-number="2"></a>
<a class="sourceLine" id="cb642-3" data-line-number="3"><span class="co">#library(GGally) # ukoliko je potrebno</span></a>
<a class="sourceLine" id="cb642-4" data-line-number="4"><span class="kw">ggpairs</span>(mtCarsNumPred)</a></code></pre></div>
<p><img src="osnoveR_files/figure-html/unnamed-chunk-498-1.png" width="672" /></p>
</div>
<hr />
<p>Još jedan zgodan način vizualizacije kolinearnosti nam pruža funkcija <code>corrplot</code> istoimenog paketa.</p>
<p><strong>Zadatak 13.12 - funkcija <code>corrplot</code></strong></p>
<div class="sourceCode" id="cb643"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb643-1" data-line-number="1"><span class="co"># učitajte paket `corrplot` (instalirajte ako je potrebno)</span></a>
<a class="sourceLine" id="cb643-2" data-line-number="2"><span class="co"># pozovite funkciju `corrplot` kojoj ćete proslijediti korelacijsku matricu</span></a>
<a class="sourceLine" id="cb643-3" data-line-number="3"><span class="co"># stupaca okvira `mtCarsNumPred`</span></a></code></pre></div>
<div class="fold s o">
<div class="sourceCode" id="cb644"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb644-1" data-line-number="1"><span class="co"># učitajte paket `corrplot` (instalirajte ako je potrebno)</span></a>
<a class="sourceLine" id="cb644-2" data-line-number="2"><span class="co"># pozovite funkciju `corrplot` kojoj ćete proslijediti korelacijsku matricu</span></a>
<a class="sourceLine" id="cb644-3" data-line-number="3"><span class="co"># stupaca okvira `mtCarsNumPred`</span></a>
<a class="sourceLine" id="cb644-4" data-line-number="4"></a>
<a class="sourceLine" id="cb644-5" data-line-number="5"><span class="co">#library(corrplot) ako je potrebno</span></a>
<a class="sourceLine" id="cb644-6" data-line-number="6"><span class="kw">corrplot</span>(<span class="kw">cor</span>(mtCarsNumPred))</a></code></pre></div>
<p><img src="osnoveR_files/figure-html/unnamed-chunk-500-1.png" width="672" /></p>
</div>
<p>Vidimo da neke varijable (npr. <code>disp</code> i <code>wt</code>, koje predstavljaju volumen motora i težinu vozila) imaju vrlo visoku razinu kolinearnosti, što znači da zahtijevaju posebnu pažnju.</p>
<p>Kolinearnost varijabli koju smo gledali tiče se parova varijablu, no moguća je i jedna interesantna pojava - tzv. <em>multikolinearnost</em>. Kod ove pojave moguće je da se kolinearnost očituje tek u kombinaciji tri i više varijabli, tj. kod gledanja zasebnih parova ne vidimo ništa neobično ali negativni učinak kolinearnosti i dalje postoji.</p>
<p>Kako bi se olakšalo uočavanje ove pojave, razvijena je tzv. VIF mjera (engl. <em>variance inflation factor</em>). Ovdje nećemo detaljno objašnjavati značenje i teoriju iza ove mjere, nego samo navesti činjenicu kako ju upotrijebiti u našem linearnom modelu te kako interpretirati dobivene vrijednosti.</p>
<p>VIF mjeru izračunavamo uz pomoć funkcije <code>vif</code> koju možemo naći u paketu <code>car</code>. Ova funkcija kao parametar očekuje linearni model kojeg analiziramo. Kao rezultat dobivamo numerički vektor sa VIF vrijednostima svake ulazne varijable. Opet, nema egzaktne granice što predstavlja “visoku” VIF vrijednost - u literaturi nailazimo na različite naputke, a kao granica se spominje vrijednost 5, vrijednost 10 i sl. Kao općenito pravilo možemo zapamtiti da dvoznamenkasti VIF označava “problematičnu” ulaznu varijablu.</p>
<hr />
<p><strong>Zadatak 13.13 - multikolinearnost</strong></p>
<div class="sourceCode" id="cb645"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb645-1" data-line-number="1"><span class="co"># istrenirajte linearni model `lm_sve` koja za okvir `mtcars`</span></a>
<a class="sourceLine" id="cb645-2" data-line-number="2"><span class="co"># gleda ovisnost varijable `mpg` o svim ostalim varijablama</span></a>
<a class="sourceLine" id="cb645-3" data-line-number="3"><span class="co">#</span></a>
<a class="sourceLine" id="cb645-4" data-line-number="4"><span class="co"># navedeni model proslijedite funkciji `vif` paketa `cars` i ispišite rezultat</span></a></code></pre></div>
<div class="sourceCode" id="cb646"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb646-1" data-line-number="1"><span class="co">#library(car)  # ako je potrebno</span></a>
<a class="sourceLine" id="cb646-2" data-line-number="2">lm_sve &lt;-<span class="st"> </span><span class="kw">lm</span>(mpg <span class="op">~</span><span class="st"> </span>., <span class="dt">data =</span> mtcars)</a>
<a class="sourceLine" id="cb646-3" data-line-number="3"><span class="kw">vif</span>(lm_sve)</a></code></pre></div>
<pre><code>##       cyl      disp        hp      drat        wt      qsec        vs 
## 15.373833 21.620241  9.832037  3.374620 15.164887  7.527958  4.965873 
##        am      gear      carb 
##  4.648487  5.357452  7.908747</code></pre>
<hr />
<p>Sad kada znamo da je kolinearnost ulaznih varijabli potencijalni problem, možemo postaviti pitanje - što učiniti kada uočimo navedenu pojavu? Neke od mogućih rješenja su:</p>
<ul>
<li>izbaciti jednu od para problematičnih varijabli</li>
<li>transformirati kolinearne varijable u alternativnu jedinstvenu ulaznu varijablu</li>
</ul>
<hr />
<p><strong>Zadatak 13.14 - linearni model sa kolinearnim ulazima</strong></p>
<div class="sourceCode" id="cb648"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb648-1" data-line-number="1"><span class="co"># trenirajte sljedeće linearne modele:</span></a>
<a class="sourceLine" id="cb648-2" data-line-number="2"><span class="co">#  `lm1` - `mpg` u ovisnosti o `disp`</span></a>
<a class="sourceLine" id="cb648-3" data-line-number="3"><span class="co">#  `lm2` - `mpg` u ovisnosti o `wt`</span></a>
<a class="sourceLine" id="cb648-4" data-line-number="4"><span class="co">#  `lm3` - `mpg` u ovisnosti o `disp` i `wt`</span></a>
<a class="sourceLine" id="cb648-5" data-line-number="5"></a>
<a class="sourceLine" id="cb648-6" data-line-number="6"><span class="co"># proučite sažetke dobivenih linearnih modela,</span></a>
<a class="sourceLine" id="cb648-7" data-line-number="7"><span class="co"># poglavito t-vrijednosti parametara i prilagođenu R-kvadrat mjeru</span></a></code></pre></div>
<div class="fold s o">
<div class="sourceCode" id="cb649"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb649-1" data-line-number="1">lm1 &lt;-<span class="st"> </span><span class="kw">lm</span>(mpg <span class="op">~</span><span class="st"> </span>disp, <span class="dt">data =</span> mtcars)</a>
<a class="sourceLine" id="cb649-2" data-line-number="2">lm2 &lt;-<span class="st"> </span><span class="kw">lm</span>(mpg <span class="op">~</span><span class="st"> </span>wt, <span class="dt">data =</span> mtcars)</a>
<a class="sourceLine" id="cb649-3" data-line-number="3">lm3 &lt;-<span class="st"> </span><span class="kw">lm</span>(mpg <span class="op">~</span><span class="st"> </span>disp <span class="op">+</span><span class="st"> </span>wt, <span class="dt">data =</span> mtcars)</a></code></pre></div>
</div>
<div class="fold s o">
<div class="sourceCode" id="cb650"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb650-1" data-line-number="1"><span class="kw">summary</span>(lm1)</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = mpg ~ disp, data = mtcars)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -4.8922 -2.2022 -0.9631  1.6272  7.2305 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 29.599855   1.229720  24.070  &lt; 2e-16 ***
## disp        -0.041215   0.004712  -8.747 9.38e-10 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 3.251 on 30 degrees of freedom
## Multiple R-squared:  0.7183, Adjusted R-squared:  0.709 
## F-statistic: 76.51 on 1 and 30 DF,  p-value: 9.38e-10</code></pre>
</div>
<div class="fold s o">
<div class="sourceCode" id="cb652"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb652-1" data-line-number="1"><span class="kw">summary</span>(lm2)</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = mpg ~ wt, data = mtcars)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -4.5432 -2.3647 -0.1252  1.4096  6.8727 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  37.2851     1.8776  19.858  &lt; 2e-16 ***
## wt           -5.3445     0.5591  -9.559 1.29e-10 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 3.046 on 30 degrees of freedom
## Multiple R-squared:  0.7528, Adjusted R-squared:  0.7446 
## F-statistic: 91.38 on 1 and 30 DF,  p-value: 1.294e-10</code></pre>
</div>
<div class="fold s o">
<div class="sourceCode" id="cb654"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb654-1" data-line-number="1"><span class="kw">summary</span>(lm3)</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = mpg ~ disp + wt, data = mtcars)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -3.4087 -2.3243 -0.7683  1.7721  6.3484 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 34.96055    2.16454  16.151 4.91e-16 ***
## disp        -0.01773    0.00919  -1.929  0.06362 .  
## wt          -3.35082    1.16413  -2.878  0.00743 ** 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 2.917 on 29 degrees of freedom
## Multiple R-squared:  0.7809, Adjusted R-squared:  0.7658 
## F-statistic: 51.69 on 2 and 29 DF,  p-value: 2.744e-10</code></pre>
</div>
<hr />
<p>Usporedivši rezultate dobivenih linearnih modela možemo zaključiti kako linearni model <code>lm3</code> ima najmanju standardnu grešku reziduala i najveću “R-kvadrat” mjeru te je time najbolja od tri opcije. No potencijalni problem se očituje kada pogledamo p-vrijednosti, koje su obje znatno veće nego kada smo trenirali modele sa svakom varijablom zasebno. Dakle, kolinearnost varijabli ne mora nužno utjecati na prediktivnu moć modela, ali unosi potencijalno veliku nesigurnost u modelu smislu da sve kolinearne prediktore izbacimo iz modela kao irelevantne. To bi se mogao pokazati kao velik problem kada imamo više potencijalnih prediktora i pokušavamo odabrati relevantni podskup, što je tema kojom ćemo se baviti u nastavku.</p>
<hr />
<p>U prethodnom zadatku vidjeli smo kako se i kod relativno jednostavne prediktivne metode višestruke regresije sa dvije potencijalne ulazne varijable pojavljuje niz pitanja vezanih uz odabir formule tj. ulaznih varijabli. Ova problematika se višestruko komplicira kako broj potencijalnih ulaznih varijabli raste. Zbog toga je odabir varijabli (<em>variable selection</em>) jedan od ključnih izazova s kojima se suočavamo u izradi prediktivnih modela, ne samo kod linearne regresije već i općenito.</p>
<p>Očito je da bi dobar model trebao sadržavati ulazne varijable koje dobro “objašnjavaju” ciljnu varijablu a koje su što više međusobno nezavisne. Mogući kriterij za odluku koje varijablu odabrati za ugrađivanje u model tako može biti utjecaj na povećanje zajedničke “R-kvadrat” mjere, smanjenje standardne greške reziduala ili p-vrijednost koeficijenta za tu ulaznu varijablu. Pored ovih “standardnih” kriterija postoje i razni drugi, kao npr. popularni AIC (engl. <em>Akaike information criterion</em>) koji procjenjuje informativnost modela uz penaliziranje većeg broj varijabli.</p>
<hr />
<p>Varijable možemo odabirati ručno, no puno je lakše taj posao ostaviti računalu. Statistički alati, uključujući i jezik R, često imaju ugrađene algoritme koji na osnovu zadanog kriterija izgrađuju prediktivni model iterativnim odabirom varijabli. Najčešće strategije izgradnje modela su:</p>
<ul>
<li>“unatrag” od potpunog modela, npr. iterativno se izbacuju varijable sa najvećom p-vrijednosti</li>
<li>“unaprijed” od praznog modela, npr. iterativno se dodaju varijable koje najviše smanjuju RMSE</li>
<li>razne hibridne metode</li>
</ul>
<hr />
<p>Jezik R ima funkciju <code>step</code> za iterativno (engl. <em>stepwise</em>) stvaranje prediktivnih modela, no u praksi se preporučuje puno bolja funkcija <code>stepAIC</code> koju možemo naći u paketu <code>MASS</code>. Ova funkcija između ostalog očekuje sljedeće parametre:</p>
<ul>
<li><code>object</code> - inicijalni (linearni) model</li>
<li><code>scope</code> - raspon modela koje uključujemo u strategiju; potreban je samo za izgradnju “unaprijed” a prosljeđujemo joj listu sa “najsiromašnijim” (<code>lower</code>) i “najbogatijim” (<code>upper</code>) modelom</li>
<li><code>direction</code> - unaprijed (<code>forward</code>), unatrag (<code>backward</code>) ili hibridno (<code>both</code>)</li>
<li><code>trace</code> - binarna varijabla koja opisuje želimo li ispis cijelog procesa odabira varijabli</li>
</ul>
<p>(Napomena: paket <code>MASS</code> ima “svoju” funkciju <code>select</code> koja može “prekriti” funkciju <code>select</code> iz paketa <code>dplyr</code>; ovo ne znači da je ta funkcija nedostupna, već da ju nakon učitavanja paketa <code>MASS</code> moramo pozivati sa njenim “punim” imenom, <code>dplyr::select</code>)</p>
<p>Za kraj ćemo iterativno stvoriti prediktivni model za podatkovni okvir <code>mtcars</code> gdje će opet ciljna varijabla biti potrošnja (varijabla <code>mpg</code>) dok će kandidati za ulaznu varijablu biti sve ostale varijable.</p>
<hr />
<p><strong>Zadatak 13.15 - iterativna selekcija varijabli za linearnu regresiju</strong></p>
<div class="sourceCode" id="cb656"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb656-1" data-line-number="1"><span class="co">#library(MASS) # ako je potrebno</span></a>
<a class="sourceLine" id="cb656-2" data-line-number="2"></a>
<a class="sourceLine" id="cb656-3" data-line-number="3"><span class="co"># stvaramo &quot;potpuni&quot; i &quot;prazni&quot; model </span></a>
<a class="sourceLine" id="cb656-4" data-line-number="4">lm_sve &lt;-<span class="st"> </span><span class="kw">lm</span>(mpg <span class="op">~</span><span class="st"> </span>., <span class="dt">data =</span> mtcars)   </a>
<a class="sourceLine" id="cb656-5" data-line-number="5">lm_prazan &lt;-<span class="st"> </span><span class="kw">lm</span>(mpg <span class="op">~</span><span class="st"> </span><span class="dv">1</span>, <span class="dt">data =</span> mtcars)</a>
<a class="sourceLine" id="cb656-6" data-line-number="6"></a>
<a class="sourceLine" id="cb656-7" data-line-number="7"><span class="co"># pogledajte sažetke gornjih modela kako bi </span></a>
<a class="sourceLine" id="cb656-8" data-line-number="8"><span class="co"># dobili dojam kako rade &quot;ekstremi&quot;</span></a>
<a class="sourceLine" id="cb656-9" data-line-number="9"></a>
<a class="sourceLine" id="cb656-10" data-line-number="10"><span class="co"># uz pomoć funkcije `stepAIC` stvorite modele `lm1` i `lm2` </span></a>
<a class="sourceLine" id="cb656-11" data-line-number="11"><span class="co"># na sljedeći način</span></a>
<a class="sourceLine" id="cb656-12" data-line-number="12"><span class="co"># `lm1` - nastaje selekcijom &quot;unatrag&quot; od punog modela</span></a>
<a class="sourceLine" id="cb656-13" data-line-number="13"><span class="co">#         (parametar direction = &quot;backward&quot;)</span></a>
<a class="sourceLine" id="cb656-14" data-line-number="14"><span class="co"># `lm2` - nastaje selekcijom &quot;unaprijed&quot; od praznog modela</span></a>
<a class="sourceLine" id="cb656-15" data-line-number="15"><span class="co">#         (parametri direction = &quot;forward&quot; , </span></a>
<a class="sourceLine" id="cb656-16" data-line-number="16"><span class="co">#         scope = list(upper = lm_sve, lower = lm_prazan))</span></a>
<a class="sourceLine" id="cb656-17" data-line-number="17"><span class="co">#</span></a>
<a class="sourceLine" id="cb656-18" data-line-number="18"><span class="co"># proučite sažetke dobivenih modela</span></a></code></pre></div>
<div class="fold s o">
<div class="sourceCode" id="cb657"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb657-1" data-line-number="1"><span class="kw">summary</span>(lm_sve)</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = mpg ~ ., data = mtcars)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -3.4506 -1.6044 -0.1196  1.2193  4.6271 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)  
## (Intercept) 12.30337   18.71788   0.657   0.5181  
## cyl         -0.11144    1.04502  -0.107   0.9161  
## disp         0.01334    0.01786   0.747   0.4635  
## hp          -0.02148    0.02177  -0.987   0.3350  
## drat         0.78711    1.63537   0.481   0.6353  
## wt          -3.71530    1.89441  -1.961   0.0633 .
## qsec         0.82104    0.73084   1.123   0.2739  
## vs1          0.31776    2.10451   0.151   0.8814  
## am1          2.52023    2.05665   1.225   0.2340  
## gear         0.65541    1.49326   0.439   0.6652  
## carb        -0.19942    0.82875  -0.241   0.8122  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 2.65 on 21 degrees of freedom
## Multiple R-squared:  0.869,  Adjusted R-squared:  0.8066 
## F-statistic: 13.93 on 10 and 21 DF,  p-value: 3.793e-07</code></pre>
</div>
<div class="fold s o">
<div class="sourceCode" id="cb659"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb659-1" data-line-number="1"><span class="kw">summary</span>(lm_prazan)</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = mpg ~ 1, data = mtcars)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -9.6906 -4.6656 -0.8906  2.7094 13.8094 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   20.091      1.065   18.86   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 6.027 on 31 degrees of freedom</code></pre>
</div>
<div class="fold s o">
<div class="sourceCode" id="cb661"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb661-1" data-line-number="1">lm1 &lt;-<span class="st"> </span><span class="kw">stepAIC</span>(lm_sve, <span class="dt">direction=</span><span class="st">&quot;backward&quot;</span>, <span class="dt">trace =</span> <span class="dv">0</span>) </a>
<a class="sourceLine" id="cb661-2" data-line-number="2"><span class="kw">summary</span>(lm1)</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = mpg ~ wt + qsec + am, data = mtcars)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -3.4811 -1.5555 -0.7257  1.4110  4.6610 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   9.6178     6.9596   1.382 0.177915    
## wt           -3.9165     0.7112  -5.507 6.95e-06 ***
## qsec          1.2259     0.2887   4.247 0.000216 ***
## am1           2.9358     1.4109   2.081 0.046716 *  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 2.459 on 28 degrees of freedom
## Multiple R-squared:  0.8497, Adjusted R-squared:  0.8336 
## F-statistic: 52.75 on 3 and 28 DF,  p-value: 1.21e-11</code></pre>
</div>
<div class="fold s o">
<div class="sourceCode" id="cb663"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb663-1" data-line-number="1">lm2 &lt;-<span class="st"> </span><span class="kw">stepAIC</span>(lm_prazan, <span class="dt">scope =</span> <span class="kw">list</span>(<span class="dt">upper =</span> lm_sve, <span class="dt">lower =</span> lm_prazan), </a>
<a class="sourceLine" id="cb663-2" data-line-number="2">                <span class="dt">direction=</span><span class="st">&quot;forward&quot;</span>, <span class="dt">trace =</span> <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb663-3" data-line-number="3"><span class="kw">summary</span>(lm2)</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = mpg ~ wt + cyl + hp, data = mtcars)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -3.9290 -1.5598 -0.5311  1.1850  5.8986 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 38.75179    1.78686  21.687  &lt; 2e-16 ***
## wt          -3.16697    0.74058  -4.276 0.000199 ***
## cyl         -0.94162    0.55092  -1.709 0.098480 .  
## hp          -0.01804    0.01188  -1.519 0.140015    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 2.512 on 28 degrees of freedom
## Multiple R-squared:  0.8431, Adjusted R-squared:  0.8263 
## F-statistic: 50.17 on 3 and 28 DF,  p-value: 2.184e-11</code></pre>
</div>
<hr />
<p>Vidimo da su dvije strategije rezultirale sa dva potpuno različita modela sličnih performansi. To znači da ne možemo očekivati pronalazak optimalnog modela, već samo automatizirani pokušaj pronalaska “najboljeg” uz kriterije i uvjete koje smo inicijalno postavili. Ukoliko nismo zadovoljni rezultatom, uvijek možemo pokušati sa alternativnim parametrima funkcije, drugom strategijom ili inicijalnim skupom ulaznih varijabli. U svakom slučaju, pronalazak zadovoljavajućeg prediktivnog modela nije jednostavan problem, a uvijek je poželjno sjetiti se citata koji se često pronalazi u knjigama o statistici i strojnom učenju, a kojeg je navodno izrekao statističar George Box - “Svi modeli su pogrešni, ali neki su korisni”.</p>
<hr />
<p><a rel="license" href="http://creativecommons.org/licenses/by-nc-nd/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-nc-nd/4.0/88x31.png" /></a><br /><span xmlns:dct="http://purl.org/dc/terms/" property="dct:title">Programirajmo u R-u</span> by <a xmlns:cc="http://creativecommons.org/ns#" href="https://www.fer.unizg.hr/en/damir.pintar" property="cc:attributionName" rel="cc:attributionURL">Damir Pintar</a> is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-nc-nd/4.0/">Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 International License</a>.<br />Based on a work at <a xmlns:dct="http://purl.org/dc/terms/" href="https://ratnip.github.io/FER_OPJR/" rel="dct:source">https://ratnip.github.io/FER_OPJR/</a></p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="ggplot2.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="prediktivno-modeliranje.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section",
"scroll_highlight": true
},
"toolbar": {
"position": "fixed",
"edit": null,
"download": null,
"search": true
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
